# -*- tcl -*-

source test_procs.tcl

############################################################################
# Tests 1.* - basic list/create/modify/show/delete operations
############################################################################

test ppp_profile-1.1 { List ppp profiles } \
    { l2tpdRunning && pppProfile } \
    { \
	clearResult
	l2tpConfig test log message=ppp_profile-1.1
	l2tpConfig ppp profile list
    } \
    {

	default
}

test ppp_profile-1.2 { Create a ppp profile 'one' } \
    { l2tpdRunning && pppProfile } \
    { \
	clearResult
	l2tpConfig test log message=ppp_profile-1.2
	l2tpConfig ppp profile create profile_name=one
	l2tpConfig ppp profile list
    } \
    {

Created ppp profile one
	default
	one
}

test ppp_profile-1.3 { Show ppp profile 'default' } \
    { l2tpdRunning && pppProfile } \
    { \
	clearResult
	l2tpConfig test log message=ppp_profile-1.3
	l2tpConfig ppp profile show profile_name=default
    } \
    {

Ppp profile default
  trace flags: PROTOCOL FSM API AVP AVPHIDE AVPDATA FUNC XPRT DATA PPP SYSTEM
  mru: 1500, mtu: 1500, mode: SYNC|ASYNC
  allowed authentications: PAP CHAP MSCHAP MSCHAPv2 EAP 
  max connect time: 0, max failure count: 10, idle timeout: 0
  multilink: NO
  IP parameters:-
    local address: NOT SET, peer address: NOT SET
    dns addresses: NOT SET / NOT SET
    wins addresses: NOT SET / NOT SET
    use radius: NO
  PAP parameters:-
    max auth requests: 10, restart interval: 3, timeout: 0
  CHAP parameters:-
    interval: 10, max challenge: 10, restart: 3
  LCP parameters:-
    echo failure count: 0, echo interval: 0
    max config requests: 10, max config naks: 10
    max terminate requests: 3, retransmit interval: 3
  IPCP parameters:-
    max config requests: 10, max config naks: 10
    max terminate requests: 3, retransmit interval: 3
  use count: 0

}

test ppp_profile-1.4 { Show ppp profile 'one' } \
    { l2tpdRunning && pppProfile } \
    { \
	clearResult
	l2tpConfig test log message=ppp_profile-1.4
	l2tpConfig ppp profile show profile_name=one
    } \
    {

Ppp profile one
  trace flags: PROTOCOL FSM API AVP AVPHIDE AVPDATA FUNC XPRT DATA PPP SYSTEM
  mru: 1500, mtu: 1500, mode: SYNC|ASYNC
  allowed authentications: PAP CHAP MSCHAP MSCHAPv2 EAP 
  max connect time: 0, max failure count: 10, idle timeout: 0
  multilink: NO
  IP parameters:-
    local address: NOT SET, peer address: NOT SET
    dns addresses: NOT SET / NOT SET
    wins addresses: NOT SET / NOT SET
    use radius: NO
  PAP parameters:-
    max auth requests: 10, restart interval: 3, timeout: 0
  CHAP parameters:-
    interval: 10, max challenge: 10, restart: 3
  LCP parameters:-
    echo failure count: 0, echo interval: 0
    max config requests: 10, max config naks: 10
    max terminate requests: 3, retransmit interval: 3
  IPCP parameters:-
    max config requests: 10, max config naks: 10
    max terminate requests: 3, retransmit interval: 3
  use count: 0

}

test ppp_profile-1.5 { Modify ppp profile 'one' } \
    { l2tpdRunning && pppProfile } \
    { \
	clearResult
	l2tpConfig test log message=ppp_profile-1.5
	l2tpConfig ppp profile modify profile_name=one idle_timeout=59
	l2tpConfig ppp profile show profile_name=one
    } \
    {

Modified ppp profile one
Ppp profile one
  trace flags: PROTOCOL FSM API AVP AVPHIDE AVPDATA FUNC XPRT DATA PPP SYSTEM
  mru: 1500, mtu: 1500, mode: SYNC|ASYNC
  allowed authentications: PAP CHAP MSCHAP MSCHAPv2 EAP 
  max connect time: 0, max failure count: 10, idle timeout: 59
  multilink: NO
  IP parameters:-
    local address: NOT SET, peer address: NOT SET
    dns addresses: NOT SET / NOT SET
    wins addresses: NOT SET / NOT SET
    use radius: NO
  PAP parameters:-
    max auth requests: 10, restart interval: 3, timeout: 0
  CHAP parameters:-
    interval: 10, max challenge: 10, restart: 3
  LCP parameters:-
    echo failure count: 0, echo interval: 0
    max config requests: 10, max config naks: 10
    max terminate requests: 3, retransmit interval: 3
  IPCP parameters:-
    max config requests: 10, max config naks: 10
    max terminate requests: 3, retransmit interval: 3
  use count: 0

}

test ppp_profile-1.6 { Delete a ppp profile 'one' } \
    { l2tpdRunning && pppProfile } \
    { \
	clearResult
	l2tpConfig test log message=ppp_profile-1.6
	l2tpConfig ppp profile delete profile_name=one
	l2tpConfig ppp profile list
    } \
    {

Deleted ppp profile one
	default
}

test ppp_profile-1.7 { Create ppp profile that already exists } \
    { l2tpdRunning && pppProfile } \
    { \
	clearResult
	l2tpConfig test log message=ppp_profile-1.7
	l2tpConfig ppp profile create profile_name=one
	l2tpConfig ppp profile list
	l2tpConfig ppp profile create profile_name=one
	l2tpConfig ppp profile list
	l2tpConfig ppp profile delete profile_name=one
    } \
    {

Created ppp profile one
	default
	one
Error at or near 'create'
Operation failed: Profile already exists
	default
	one
Deleted ppp profile one
}

############################################################################
# Tests 2.* - optional create parameters
############################################################################

test ppp_profile-2.1 { Create ppp profile idle_timeout= } \
    { l2tpdRunning && pppProfile } \
    { \
	clearResult
	l2tpConfig test log message=ppp_profile-2.1
	l2tpConfig ppp profile create profile_name=one idle_timeout=59
	l2tpConfig ppp profile show profile_name=one
	l2tpConfig ppp profile delete profile_name=one
    } \
    {

Created ppp profile one
Ppp profile one
  trace flags: PROTOCOL FSM API AVP AVPHIDE AVPDATA FUNC XPRT DATA PPP SYSTEM
  mru: 1500, mtu: 1500, mode: SYNC|ASYNC
  allowed authentications: PAP CHAP MSCHAP MSCHAPv2 EAP 
  max connect time: 0, max failure count: 10, idle timeout: 59
  multilink: NO
  IP parameters:-
    local address: NOT SET, peer address: NOT SET
    dns addresses: NOT SET / NOT SET
    wins addresses: NOT SET / NOT SET
    use radius: NO
  PAP parameters:-
    max auth requests: 10, restart interval: 3, timeout: 0
  CHAP parameters:-
    interval: 10, max challenge: 10, restart: 3
  LCP parameters:-
    echo failure count: 0, echo interval: 0
    max config requests: 10, max config naks: 10
    max terminate requests: 3, retransmit interval: 3
  IPCP parameters:-
    max config requests: 10, max config naks: 10
    max terminate requests: 3, retransmit interval: 3
  use count: 0

Deleted ppp profile one
}

test ppp_profile-2.2 { Create ppp profile trace_flags= } \
    { l2tpdRunning && pppProfile } \
    { \
	clearResult
	l2tpConfig test log message=ppp_profile-2.2
	l2tpConfig ppp profile create profile_name=one trace_flags=7
	l2tpConfig ppp profile show profile_name=one
	l2tpConfig ppp profile delete profile_name=one
    } \
    {

Created ppp profile one
Ppp profile one
  trace flags: PROTOCOL FSM API
  mru: 1500, mtu: 1500, mode: SYNC|ASYNC
  allowed authentications: PAP CHAP MSCHAP MSCHAPv2 EAP 
  max connect time: 0, max failure count: 10, idle timeout: 0
  multilink: NO
  IP parameters:-
    local address: NOT SET, peer address: NOT SET
    dns addresses: NOT SET / NOT SET
    wins addresses: NOT SET / NOT SET
    use radius: NO
  PAP parameters:-
    max auth requests: 10, restart interval: 3, timeout: 0
  CHAP parameters:-
    interval: 10, max challenge: 10, restart: 3
  LCP parameters:-
    echo failure count: 0, echo interval: 0
    max config requests: 10, max config naks: 10
    max terminate requests: 3, retransmit interval: 3
  IPCP parameters:-
    max config requests: 10, max config naks: 10
    max terminate requests: 3, retransmit interval: 3
  use count: 0

Deleted ppp profile one
}

test ppp_profile-2.3 { Create ppp profile asyncmap= } \
    { l2tpdRunning && pppProfile } \
    { \
	clearResult
	l2tpConfig test log message=ppp_profile-2.3
	l2tpConfig ppp profile create profile_name=one asyncmap=0x42
	l2tpConfig ppp profile show profile_name=one
	l2tpConfig ppp profile delete profile_name=one
    } \
    {

Created ppp profile one
Ppp profile one
  trace flags: PROTOCOL FSM API AVP AVPHIDE AVPDATA FUNC XPRT DATA PPP SYSTEM
  mru: 1500, mtu: 1500, mode: SYNC|ASYNC
  allowed authentications: PAP CHAP MSCHAP MSCHAPv2 EAP 
  max connect time: 0, max failure count: 10, idle timeout: 0
  asyncmap: 0x42
  multilink: NO
  IP parameters:-
    local address: NOT SET, peer address: NOT SET
    dns addresses: NOT SET / NOT SET
    wins addresses: NOT SET / NOT SET
    use radius: NO
  PAP parameters:-
    max auth requests: 10, restart interval: 3, timeout: 0
  CHAP parameters:-
    interval: 10, max challenge: 10, restart: 3
  LCP parameters:-
    echo failure count: 0, echo interval: 0
    max config requests: 10, max config naks: 10
    max terminate requests: 3, retransmit interval: 3
  IPCP parameters:-
    max config requests: 10, max config naks: 10
    max terminate requests: 3, retransmit interval: 3
  use count: 0

Deleted ppp profile one
}

test ppp_profile-2.4 { Create ppp profile mtu= } \
    { l2tpdRunning && pppProfile } \
    { \
	clearResult
	l2tpConfig test log message=ppp_profile-2.4
	l2tpConfig ppp profile create profile_name=one mtu=42
	l2tpConfig ppp profile show profile_name=one
	l2tpConfig ppp profile delete profile_name=one
    } \
    {

Created ppp profile one
Ppp profile one
  trace flags: PROTOCOL FSM API AVP AVPHIDE AVPDATA FUNC XPRT DATA PPP SYSTEM
  mru: 1500, mtu: 42, mode: SYNC|ASYNC
  allowed authentications: PAP CHAP MSCHAP MSCHAPv2 EAP 
  max connect time: 0, max failure count: 10, idle timeout: 0
  multilink: NO
  IP parameters:-
    local address: NOT SET, peer address: NOT SET
    dns addresses: NOT SET / NOT SET
    wins addresses: NOT SET / NOT SET
    use radius: NO
  PAP parameters:-
    max auth requests: 10, restart interval: 3, timeout: 0
  CHAP parameters:-
    interval: 10, max challenge: 10, restart: 3
  LCP parameters:-
    echo failure count: 0, echo interval: 0
    max config requests: 10, max config naks: 10
    max terminate requests: 3, retransmit interval: 3
  IPCP parameters:-
    max config requests: 10, max config naks: 10
    max terminate requests: 3, retransmit interval: 3
  use count: 0

Deleted ppp profile one
}

test ppp_profile-2.5 { Create ppp profile mru= } \
    { l2tpdRunning && pppProfile } \
    { \
	clearResult
	l2tpConfig test log message=ppp_profile-2.5
	l2tpConfig ppp profile create profile_name=one mru=42
	l2tpConfig ppp profile show profile_name=one
	l2tpConfig ppp profile delete profile_name=one
    } \
    {

Created ppp profile one
Ppp profile one
  trace flags: PROTOCOL FSM API AVP AVPHIDE AVPDATA FUNC XPRT DATA PPP SYSTEM
  mru: 42, mtu: 1500, mode: SYNC|ASYNC
  allowed authentications: PAP CHAP MSCHAP MSCHAPv2 EAP 
  max connect time: 0, max failure count: 10, idle timeout: 0
  multilink: NO
  IP parameters:-
    local address: NOT SET, peer address: NOT SET
    dns addresses: NOT SET / NOT SET
    wins addresses: NOT SET / NOT SET
    use radius: NO
  PAP parameters:-
    max auth requests: 10, restart interval: 3, timeout: 0
  CHAP parameters:-
    interval: 10, max challenge: 10, restart: 3
  LCP parameters:-
    echo failure count: 0, echo interval: 0
    max config requests: 10, max config naks: 10
    max terminate requests: 3, retransmit interval: 3
  IPCP parameters:-
    max config requests: 10, max config naks: 10
    max terminate requests: 3, retransmit interval: 3
  use count: 0

Deleted ppp profile one
}

test ppp_profile-2.6 { Create ppp profile sync_mode= } \
    { l2tpdRunning && pppProfile } \
    { \
	clearResult
	l2tpConfig test log message=ppp_profile-2.6
	l2tpConfig ppp profile create profile_name=one sync_mode=sync
	l2tpConfig ppp profile show profile_name=one
	l2tpConfig ppp profile delete profile_name=one
	l2tpConfig ppp profile create profile_name=one sync_mode=async
	l2tpConfig ppp profile show profile_name=one
	l2tpConfig ppp profile delete profile_name=one
	l2tpConfig ppp profile create profile_name=one sync_mode=any
	l2tpConfig ppp profile show profile_name=one
	l2tpConfig ppp profile delete profile_name=one
    } \
    {

Created ppp profile one
Ppp profile one
  trace flags: PROTOCOL FSM API AVP AVPHIDE AVPDATA FUNC XPRT DATA PPP SYSTEM
  mru: 1500, mtu: 1500, mode: SYNC
  allowed authentications: PAP CHAP MSCHAP MSCHAPv2 EAP 
  max connect time: 0, max failure count: 10, idle timeout: 0
  multilink: NO
  IP parameters:-
    local address: NOT SET, peer address: NOT SET
    dns addresses: NOT SET / NOT SET
    wins addresses: NOT SET / NOT SET
    use radius: NO
  PAP parameters:-
    max auth requests: 10, restart interval: 3, timeout: 0
  CHAP parameters:-
    interval: 10, max challenge: 10, restart: 3
  LCP parameters:-
    echo failure count: 0, echo interval: 0
    max config requests: 10, max config naks: 10
    max terminate requests: 3, retransmit interval: 3
  IPCP parameters:-
    max config requests: 10, max config naks: 10
    max terminate requests: 3, retransmit interval: 3
  use count: 0

Deleted ppp profile one
Created ppp profile one
Ppp profile one
  trace flags: PROTOCOL FSM API AVP AVPHIDE AVPDATA FUNC XPRT DATA PPP SYSTEM
  mru: 1500, mtu: 1500, mode: ASYNC
  allowed authentications: PAP CHAP MSCHAP MSCHAPv2 EAP 
  max connect time: 0, max failure count: 10, idle timeout: 0
  multilink: NO
  IP parameters:-
    local address: NOT SET, peer address: NOT SET
    dns addresses: NOT SET / NOT SET
    wins addresses: NOT SET / NOT SET
    use radius: NO
  PAP parameters:-
    max auth requests: 10, restart interval: 3, timeout: 0
  CHAP parameters:-
    interval: 10, max challenge: 10, restart: 3
  LCP parameters:-
    echo failure count: 0, echo interval: 0
    max config requests: 10, max config naks: 10
    max terminate requests: 3, retransmit interval: 3
  IPCP parameters:-
    max config requests: 10, max config naks: 10
    max terminate requests: 3, retransmit interval: 3
  use count: 0

Deleted ppp profile one
Created ppp profile one
Ppp profile one
  trace flags: PROTOCOL FSM API AVP AVPHIDE AVPDATA FUNC XPRT DATA PPP SYSTEM
  mru: 1500, mtu: 1500, mode: SYNC|ASYNC
  allowed authentications: PAP CHAP MSCHAP MSCHAPv2 EAP 
  max connect time: 0, max failure count: 10, idle timeout: 0
  multilink: NO
  IP parameters:-
    local address: NOT SET, peer address: NOT SET
    dns addresses: NOT SET / NOT SET
    wins addresses: NOT SET / NOT SET
    use radius: NO
  PAP parameters:-
    max auth requests: 10, restart interval: 3, timeout: 0
  CHAP parameters:-
    interval: 10, max challenge: 10, restart: 3
  LCP parameters:-
    echo failure count: 0, echo interval: 0
    max config requests: 10, max config naks: 10
    max terminate requests: 3, retransmit interval: 3
  IPCP parameters:-
    max config requests: 10, max config naks: 10
    max terminate requests: 3, retransmit interval: 3
  use count: 0

Deleted ppp profile one
}

test ppp_profile-2.7 { Create ppp profile auth_pap= } \
    { l2tpdRunning && pppProfile } \
    { \
	clearResult
	l2tpConfig test log message=ppp_profile-2.7
	l2tpConfig ppp profile create profile_name=one auth_pap=no
	l2tpConfig ppp profile show profile_name=one
	l2tpConfig ppp profile delete profile_name=one
    } \
    {

Created ppp profile one
Ppp profile one
  trace flags: PROTOCOL FSM API AVP AVPHIDE AVPDATA FUNC XPRT DATA PPP SYSTEM
  mru: 1500, mtu: 1500, mode: SYNC|ASYNC
  allowed authentications: CHAP MSCHAP MSCHAPv2 EAP 
  max connect time: 0, max failure count: 10, idle timeout: 0
  multilink: NO
  IP parameters:-
    local address: NOT SET, peer address: NOT SET
    dns addresses: NOT SET / NOT SET
    wins addresses: NOT SET / NOT SET
    use radius: NO
  PAP parameters:-
    max auth requests: 10, restart interval: 3, timeout: 0
  CHAP parameters:-
    interval: 10, max challenge: 10, restart: 3
  LCP parameters:-
    echo failure count: 0, echo interval: 0
    max config requests: 10, max config naks: 10
    max terminate requests: 3, retransmit interval: 3
  IPCP parameters:-
    max config requests: 10, max config naks: 10
    max terminate requests: 3, retransmit interval: 3
  use count: 0

Deleted ppp profile one
}

test ppp_profile-2.8 { Create ppp profile auth_chap= } \
    { l2tpdRunning && pppProfile } \
    { \
	clearResult
	l2tpConfig test log message=ppp_profile-2.8
	l2tpConfig ppp profile create profile_name=one auth_chap=no
	l2tpConfig ppp profile show profile_name=one
	l2tpConfig ppp profile delete profile_name=one
    } \
    {

Created ppp profile one
Ppp profile one
  trace flags: PROTOCOL FSM API AVP AVPHIDE AVPDATA FUNC XPRT DATA PPP SYSTEM
  mru: 1500, mtu: 1500, mode: SYNC|ASYNC
  allowed authentications: PAP MSCHAP MSCHAPv2 EAP 
  max connect time: 0, max failure count: 10, idle timeout: 0
  multilink: NO
  IP parameters:-
    local address: NOT SET, peer address: NOT SET
    dns addresses: NOT SET / NOT SET
    wins addresses: NOT SET / NOT SET
    use radius: NO
  PAP parameters:-
    max auth requests: 10, restart interval: 3, timeout: 0
  CHAP parameters:-
    interval: 10, max challenge: 10, restart: 3
  LCP parameters:-
    echo failure count: 0, echo interval: 0
    max config requests: 10, max config naks: 10
    max terminate requests: 3, retransmit interval: 3
  IPCP parameters:-
    max config requests: 10, max config naks: 10
    max terminate requests: 3, retransmit interval: 3
  use count: 0

Deleted ppp profile one
}

test ppp_profile-2.9 { Create ppp profile auth_mschapv1= } \
    { l2tpdRunning && pppProfile } \
    { \
	clearResult
	l2tpConfig test log message=ppp_profile-2.9
	l2tpConfig ppp profile create profile_name=one auth_mschapv1=no
	l2tpConfig ppp profile show profile_name=one
	l2tpConfig ppp profile delete profile_name=one
    } \
    {

Created ppp profile one
Ppp profile one
  trace flags: PROTOCOL FSM API AVP AVPHIDE AVPDATA FUNC XPRT DATA PPP SYSTEM
  mru: 1500, mtu: 1500, mode: SYNC|ASYNC
  allowed authentications: PAP CHAP MSCHAPv2 EAP 
  max connect time: 0, max failure count: 10, idle timeout: 0
  multilink: NO
  IP parameters:-
    local address: NOT SET, peer address: NOT SET
    dns addresses: NOT SET / NOT SET
    wins addresses: NOT SET / NOT SET
    use radius: NO
  PAP parameters:-
    max auth requests: 10, restart interval: 3, timeout: 0
  CHAP parameters:-
    interval: 10, max challenge: 10, restart: 3
  LCP parameters:-
    echo failure count: 0, echo interval: 0
    max config requests: 10, max config naks: 10
    max terminate requests: 3, retransmit interval: 3
  IPCP parameters:-
    max config requests: 10, max config naks: 10
    max terminate requests: 3, retransmit interval: 3
  use count: 0

Deleted ppp profile one
}

test ppp_profile-2.10 { Create ppp profile auth_mschapv2= } \
    { l2tpdRunning && pppProfile } \
    { \
	clearResult
	l2tpConfig test log message=ppp_profile-2.10
	l2tpConfig ppp profile create profile_name=one auth_mschapv2=no
	l2tpConfig ppp profile show profile_name=one
	l2tpConfig ppp profile delete profile_name=one
    } \
    {

Created ppp profile one
Ppp profile one
  trace flags: PROTOCOL FSM API AVP AVPHIDE AVPDATA FUNC XPRT DATA PPP SYSTEM
  mru: 1500, mtu: 1500, mode: SYNC|ASYNC
  allowed authentications: PAP CHAP MSCHAP EAP 
  max connect time: 0, max failure count: 10, idle timeout: 0
  multilink: NO
  IP parameters:-
    local address: NOT SET, peer address: NOT SET
    dns addresses: NOT SET / NOT SET
    wins addresses: NOT SET / NOT SET
    use radius: NO
  PAP parameters:-
    max auth requests: 10, restart interval: 3, timeout: 0
  CHAP parameters:-
    interval: 10, max challenge: 10, restart: 3
  LCP parameters:-
    echo failure count: 0, echo interval: 0
    max config requests: 10, max config naks: 10
    max terminate requests: 3, retransmit interval: 3
  IPCP parameters:-
    max config requests: 10, max config naks: 10
    max terminate requests: 3, retransmit interval: 3
  use count: 0

Deleted ppp profile one
}

test ppp_profile-2.11 { Create ppp profile auth_eap= } \
    { l2tpdRunning && pppProfile } \
    { \
	clearResult
	l2tpConfig test log message=ppp_profile-2.11
	l2tpConfig ppp profile create profile_name=one auth_eap=no
	l2tpConfig ppp profile show profile_name=one
	l2tpConfig ppp profile delete profile_name=one
    } \
    {

Created ppp profile one
Ppp profile one
  trace flags: PROTOCOL FSM API AVP AVPHIDE AVPDATA FUNC XPRT DATA PPP SYSTEM
  mru: 1500, mtu: 1500, mode: SYNC|ASYNC
  allowed authentications: PAP CHAP MSCHAP MSCHAPv2 
  max connect time: 0, max failure count: 10, idle timeout: 0
  multilink: NO
  IP parameters:-
    local address: NOT SET, peer address: NOT SET
    dns addresses: NOT SET / NOT SET
    wins addresses: NOT SET / NOT SET
    use radius: NO
  PAP parameters:-
    max auth requests: 10, restart interval: 3, timeout: 0
  CHAP parameters:-
    interval: 10, max challenge: 10, restart: 3
  LCP parameters:-
    echo failure count: 0, echo interval: 0
    max config requests: 10, max config naks: 10
    max terminate requests: 3, retransmit interval: 3
  IPCP parameters:-
    max config requests: 10, max config naks: 10
    max terminate requests: 3, retransmit interval: 3
  use count: 0

Deleted ppp profile one
}

test ppp_profile-2.12 { Create ppp profile auth_none= } \
    { l2tpdRunning && pppProfile } \
    { \
	clearResult
	l2tpConfig test log message=ppp_profile-2.12
	l2tpConfig ppp profile create profile_name=one auth_none=yes
	l2tpConfig ppp profile show profile_name=one
	l2tpConfig ppp profile delete profile_name=one
    } \
    {

Created ppp profile one
Ppp profile one
  trace flags: PROTOCOL FSM API AVP AVPHIDE AVPDATA FUNC XPRT DATA PPP SYSTEM
  mru: 1500, mtu: 1500, mode: SYNC|ASYNC
  allowed authentications: PAP CHAP MSCHAP MSCHAPv2 EAP NOAUTH 
  max connect time: 0, max failure count: 10, idle timeout: 0
  multilink: NO
  IP parameters:-
    local address: NOT SET, peer address: NOT SET
    dns addresses: NOT SET / NOT SET
    wins addresses: NOT SET / NOT SET
    use radius: NO
  PAP parameters:-
    max auth requests: 10, restart interval: 3, timeout: 0
  CHAP parameters:-
    interval: 10, max challenge: 10, restart: 3
  LCP parameters:-
    echo failure count: 0, echo interval: 0
    max config requests: 10, max config naks: 10
    max terminate requests: 3, retransmit interval: 3
  IPCP parameters:-
    max config requests: 10, max config naks: 10
    max terminate requests: 3, retransmit interval: 3
  use count: 0

Deleted ppp profile one
}

test ppp_profile-2.13 { Create ppp profile chap_interval= } \
    { l2tpdRunning && pppProfile } \
    { \
	clearResult
	l2tpConfig test log message=ppp_profile-2.13
	l2tpConfig ppp profile create profile_name=one chap_interval=42
	l2tpConfig ppp profile show profile_name=one
	l2tpConfig ppp profile delete profile_name=one
    } \
    {

Created ppp profile one
Ppp profile one
  trace flags: PROTOCOL FSM API AVP AVPHIDE AVPDATA FUNC XPRT DATA PPP SYSTEM
  mru: 1500, mtu: 1500, mode: SYNC|ASYNC
  allowed authentications: PAP CHAP MSCHAP MSCHAPv2 EAP 
  max connect time: 0, max failure count: 10, idle timeout: 0
  multilink: NO
  IP parameters:-
    local address: NOT SET, peer address: NOT SET
    dns addresses: NOT SET / NOT SET
    wins addresses: NOT SET / NOT SET
    use radius: NO
  PAP parameters:-
    max auth requests: 10, restart interval: 3, timeout: 0
  CHAP parameters:-
    interval: 42, max challenge: 10, restart: 3
  LCP parameters:-
    echo failure count: 0, echo interval: 0
    max config requests: 10, max config naks: 10
    max terminate requests: 3, retransmit interval: 3
  IPCP parameters:-
    max config requests: 10, max config naks: 10
    max terminate requests: 3, retransmit interval: 3
  use count: 0

Deleted ppp profile one
}

test ppp_profile-2.14 { Create ppp profile chap_max_challenge= } \
    { l2tpdRunning && pppProfile } \
    { \
	clearResult
	l2tpConfig test log message=ppp_profile-2.14
	l2tpConfig ppp profile create profile_name=one chap_max_challenge=42
	l2tpConfig ppp profile show profile_name=one
	l2tpConfig ppp profile delete profile_name=one
    } \
    {

Created ppp profile one
Ppp profile one
  trace flags: PROTOCOL FSM API AVP AVPHIDE AVPDATA FUNC XPRT DATA PPP SYSTEM
  mru: 1500, mtu: 1500, mode: SYNC|ASYNC
  allowed authentications: PAP CHAP MSCHAP MSCHAPv2 EAP 
  max connect time: 0, max failure count: 10, idle timeout: 0
  multilink: NO
  IP parameters:-
    local address: NOT SET, peer address: NOT SET
    dns addresses: NOT SET / NOT SET
    wins addresses: NOT SET / NOT SET
    use radius: NO
  PAP parameters:-
    max auth requests: 10, restart interval: 3, timeout: 0
  CHAP parameters:-
    interval: 10, max challenge: 42, restart: 3
  LCP parameters:-
    echo failure count: 0, echo interval: 0
    max config requests: 10, max config naks: 10
    max terminate requests: 3, retransmit interval: 3
  IPCP parameters:-
    max config requests: 10, max config naks: 10
    max terminate requests: 3, retransmit interval: 3
  use count: 0

Deleted ppp profile one
}

test ppp_profile-2.15 { Create ppp profile chap_restart= } \
    { l2tpdRunning && pppProfile } \
    { \
	clearResult
	l2tpConfig test log message=ppp_profile-2.15
	l2tpConfig ppp profile create profile_name=one chap_restart=42
	l2tpConfig ppp profile show profile_name=one
	l2tpConfig ppp profile delete profile_name=one
    } \
    {

Created ppp profile one
Ppp profile one
  trace flags: PROTOCOL FSM API AVP AVPHIDE AVPDATA FUNC XPRT DATA PPP SYSTEM
  mru: 1500, mtu: 1500, mode: SYNC|ASYNC
  allowed authentications: PAP CHAP MSCHAP MSCHAPv2 EAP 
  max connect time: 0, max failure count: 10, idle timeout: 0
  multilink: NO
  IP parameters:-
    local address: NOT SET, peer address: NOT SET
    dns addresses: NOT SET / NOT SET
    wins addresses: NOT SET / NOT SET
    use radius: NO
  PAP parameters:-
    max auth requests: 10, restart interval: 3, timeout: 0
  CHAP parameters:-
    interval: 10, max challenge: 10, restart: 42
  LCP parameters:-
    echo failure count: 0, echo interval: 0
    max config requests: 10, max config naks: 10
    max terminate requests: 3, retransmit interval: 3
  IPCP parameters:-
    max config requests: 10, max config naks: 10
    max terminate requests: 3, retransmit interval: 3
  use count: 0

Deleted ppp profile one
}

test ppp_profile-2.16 { Create ppp profile pap_max_auth_requests= } \
    { l2tpdRunning && pppProfile } \
    { \
	clearResult
	l2tpConfig test log message=ppp_profile-2.16
	l2tpConfig ppp profile create profile_name=one pap_max_auth_requests=42
	l2tpConfig ppp profile show profile_name=one
	l2tpConfig ppp profile delete profile_name=one
    } \
    {

Created ppp profile one
Ppp profile one
  trace flags: PROTOCOL FSM API AVP AVPHIDE AVPDATA FUNC XPRT DATA PPP SYSTEM
  mru: 1500, mtu: 1500, mode: SYNC|ASYNC
  allowed authentications: PAP CHAP MSCHAP MSCHAPv2 EAP 
  max connect time: 0, max failure count: 10, idle timeout: 0
  multilink: NO
  IP parameters:-
    local address: NOT SET, peer address: NOT SET
    dns addresses: NOT SET / NOT SET
    wins addresses: NOT SET / NOT SET
    use radius: NO
  PAP parameters:-
    max auth requests: 42, restart interval: 3, timeout: 0
  CHAP parameters:-
    interval: 10, max challenge: 10, restart: 3
  LCP parameters:-
    echo failure count: 0, echo interval: 0
    max config requests: 10, max config naks: 10
    max terminate requests: 3, retransmit interval: 3
  IPCP parameters:-
    max config requests: 10, max config naks: 10
    max terminate requests: 3, retransmit interval: 3
  use count: 0

Deleted ppp profile one
}

test ppp_profile-2.17 { Create ppp profile pap_restart_interval= } \
    { l2tpdRunning && pppProfile } \
    { \
	clearResult
	l2tpConfig test log message=ppp_profile-2.17
	l2tpConfig ppp profile create profile_name=one pap_restart_interval=42
	l2tpConfig ppp profile show profile_name=one
	l2tpConfig ppp profile delete profile_name=one
    } \
    {

Created ppp profile one
Ppp profile one
  trace flags: PROTOCOL FSM API AVP AVPHIDE AVPDATA FUNC XPRT DATA PPP SYSTEM
  mru: 1500, mtu: 1500, mode: SYNC|ASYNC
  allowed authentications: PAP CHAP MSCHAP MSCHAPv2 EAP 
  max connect time: 0, max failure count: 10, idle timeout: 0
  multilink: NO
  IP parameters:-
    local address: NOT SET, peer address: NOT SET
    dns addresses: NOT SET / NOT SET
    wins addresses: NOT SET / NOT SET
    use radius: NO
  PAP parameters:-
    max auth requests: 10, restart interval: 42, timeout: 0
  CHAP parameters:-
    interval: 10, max challenge: 10, restart: 3
  LCP parameters:-
    echo failure count: 0, echo interval: 0
    max config requests: 10, max config naks: 10
    max terminate requests: 3, retransmit interval: 3
  IPCP parameters:-
    max config requests: 10, max config naks: 10
    max terminate requests: 3, retransmit interval: 3
  use count: 0

Deleted ppp profile one
}

test ppp_profile-2.18 { Create ppp profile pap_timeout= } \
    { l2tpdRunning && pppProfile } \
    { \
	clearResult
	l2tpConfig test log message=ppp_profile-2.18
	l2tpConfig ppp profile create profile_name=one pap_timeout=42
	l2tpConfig ppp profile show profile_name=one
	l2tpConfig ppp profile delete profile_name=one
    } \
    {

Created ppp profile one
Ppp profile one
  trace flags: PROTOCOL FSM API AVP AVPHIDE AVPDATA FUNC XPRT DATA PPP SYSTEM
  mru: 1500, mtu: 1500, mode: SYNC|ASYNC
  allowed authentications: PAP CHAP MSCHAP MSCHAPv2 EAP 
  max connect time: 0, max failure count: 10, idle timeout: 0
  multilink: NO
  IP parameters:-
    local address: NOT SET, peer address: NOT SET
    dns addresses: NOT SET / NOT SET
    wins addresses: NOT SET / NOT SET
    use radius: NO
  PAP parameters:-
    max auth requests: 10, restart interval: 3, timeout: 42
  CHAP parameters:-
    interval: 10, max challenge: 10, restart: 3
  LCP parameters:-
    echo failure count: 0, echo interval: 0
    max config requests: 10, max config naks: 10
    max terminate requests: 3, retransmit interval: 3
  IPCP parameters:-
    max config requests: 10, max config naks: 10
    max terminate requests: 3, retransmit interval: 3
  use count: 0

Deleted ppp profile one
}

test ppp_profile-2.19 { Create ppp profile ipcp_max_config_requests= } \
    { l2tpdRunning && pppProfile } \
    { \
	clearResult
	l2tpConfig test log message=ppp_profile-2.19
	l2tpConfig ppp profile create profile_name=one ipcp_max_config_requests=42
	l2tpConfig ppp profile show profile_name=one
	l2tpConfig ppp profile delete profile_name=one
    } \
    {

Created ppp profile one
Ppp profile one
  trace flags: PROTOCOL FSM API AVP AVPHIDE AVPDATA FUNC XPRT DATA PPP SYSTEM
  mru: 1500, mtu: 1500, mode: SYNC|ASYNC
  allowed authentications: PAP CHAP MSCHAP MSCHAPv2 EAP 
  max connect time: 0, max failure count: 10, idle timeout: 0
  multilink: NO
  IP parameters:-
    local address: NOT SET, peer address: NOT SET
    dns addresses: NOT SET / NOT SET
    wins addresses: NOT SET / NOT SET
    use radius: NO
  PAP parameters:-
    max auth requests: 10, restart interval: 3, timeout: 0
  CHAP parameters:-
    interval: 10, max challenge: 10, restart: 3
  LCP parameters:-
    echo failure count: 0, echo interval: 0
    max config requests: 10, max config naks: 10
    max terminate requests: 3, retransmit interval: 3
  IPCP parameters:-
    max config requests: 42, max config naks: 10
    max terminate requests: 3, retransmit interval: 3
  use count: 0

Deleted ppp profile one
}

test ppp_profile-2.20 { Create ppp profile ipcp_max_config_naks= } \
    { l2tpdRunning && pppProfile } \
    { \
	clearResult
	l2tpConfig test log message=ppp_profile-2.20
	l2tpConfig ppp profile create profile_name=one ipcp_max_config_naks=42
	l2tpConfig ppp profile show profile_name=one
	l2tpConfig ppp profile delete profile_name=one
    } \
    {

Created ppp profile one
Ppp profile one
  trace flags: PROTOCOL FSM API AVP AVPHIDE AVPDATA FUNC XPRT DATA PPP SYSTEM
  mru: 1500, mtu: 1500, mode: SYNC|ASYNC
  allowed authentications: PAP CHAP MSCHAP MSCHAPv2 EAP 
  max connect time: 0, max failure count: 10, idle timeout: 0
  multilink: NO
  IP parameters:-
    local address: NOT SET, peer address: NOT SET
    dns addresses: NOT SET / NOT SET
    wins addresses: NOT SET / NOT SET
    use radius: NO
  PAP parameters:-
    max auth requests: 10, restart interval: 3, timeout: 0
  CHAP parameters:-
    interval: 10, max challenge: 10, restart: 3
  LCP parameters:-
    echo failure count: 0, echo interval: 0
    max config requests: 10, max config naks: 10
    max terminate requests: 3, retransmit interval: 3
  IPCP parameters:-
    max config requests: 10, max config naks: 42
    max terminate requests: 3, retransmit interval: 3
  use count: 0

Deleted ppp profile one
}

test ppp_profile-2.21 { Create ppp profile ipcp_max_terminate_requests= } \
    { l2tpdRunning && pppProfile } \
    { \
	clearResult
	l2tpConfig test log message=ppp_profile-2.21
	l2tpConfig ppp profile create profile_name=one ipcp_max_terminate_requests=42
	l2tpConfig ppp profile show profile_name=one
	l2tpConfig ppp profile delete profile_name=one
    } \
    {

Created ppp profile one
Ppp profile one
  trace flags: PROTOCOL FSM API AVP AVPHIDE AVPDATA FUNC XPRT DATA PPP SYSTEM
  mru: 1500, mtu: 1500, mode: SYNC|ASYNC
  allowed authentications: PAP CHAP MSCHAP MSCHAPv2 EAP 
  max connect time: 0, max failure count: 10, idle timeout: 0
  multilink: NO
  IP parameters:-
    local address: NOT SET, peer address: NOT SET
    dns addresses: NOT SET / NOT SET
    wins addresses: NOT SET / NOT SET
    use radius: NO
  PAP parameters:-
    max auth requests: 10, restart interval: 3, timeout: 0
  CHAP parameters:-
    interval: 10, max challenge: 10, restart: 3
  LCP parameters:-
    echo failure count: 0, echo interval: 0
    max config requests: 10, max config naks: 10
    max terminate requests: 3, retransmit interval: 3
  IPCP parameters:-
    max config requests: 10, max config naks: 10
    max terminate requests: 42, retransmit interval: 3
  use count: 0

Deleted ppp profile one
}

test ppp_profile-2.22 { Create ppp profile ipcp_retransmit_interval= } \
    { l2tpdRunning && pppProfile } \
    { \
	clearResult
	l2tpConfig test log message=ppp_profile-2.22
	l2tpConfig ppp profile create profile_name=one ipcp_retransmit_interval=42
	l2tpConfig ppp profile show profile_name=one
	l2tpConfig ppp profile delete profile_name=one
    } \
    {

Created ppp profile one
Ppp profile one
  trace flags: PROTOCOL FSM API AVP AVPHIDE AVPDATA FUNC XPRT DATA PPP SYSTEM
  mru: 1500, mtu: 1500, mode: SYNC|ASYNC
  allowed authentications: PAP CHAP MSCHAP MSCHAPv2 EAP 
  max connect time: 0, max failure count: 10, idle timeout: 0
  multilink: NO
  IP parameters:-
    local address: NOT SET, peer address: NOT SET
    dns addresses: NOT SET / NOT SET
    wins addresses: NOT SET / NOT SET
    use radius: NO
  PAP parameters:-
    max auth requests: 10, restart interval: 3, timeout: 0
  CHAP parameters:-
    interval: 10, max challenge: 10, restart: 3
  LCP parameters:-
    echo failure count: 0, echo interval: 0
    max config requests: 10, max config naks: 10
    max terminate requests: 3, retransmit interval: 3
  IPCP parameters:-
    max config requests: 10, max config naks: 10
    max terminate requests: 3, retransmit interval: 42
  use count: 0

Deleted ppp profile one
}

test ppp_profile-2.23 { Create ppp profile lcp_echo_failure_count= } \
    { l2tpdRunning && pppProfile } \
    { \
	clearResult
	l2tpConfig test log message=ppp_profile-2.23
	l2tpConfig ppp profile create profile_name=one lcp_echo_failure_count=42
	l2tpConfig ppp profile show profile_name=one
	l2tpConfig ppp profile delete profile_name=one
    } \
    {

Created ppp profile one
Ppp profile one
  trace flags: PROTOCOL FSM API AVP AVPHIDE AVPDATA FUNC XPRT DATA PPP SYSTEM
  mru: 1500, mtu: 1500, mode: SYNC|ASYNC
  allowed authentications: PAP CHAP MSCHAP MSCHAPv2 EAP 
  max connect time: 0, max failure count: 10, idle timeout: 0
  multilink: NO
  IP parameters:-
    local address: NOT SET, peer address: NOT SET
    dns addresses: NOT SET / NOT SET
    wins addresses: NOT SET / NOT SET
    use radius: NO
  PAP parameters:-
    max auth requests: 10, restart interval: 3, timeout: 0
  CHAP parameters:-
    interval: 10, max challenge: 10, restart: 3
  LCP parameters:-
    echo failure count: 42, echo interval: 0
    max config requests: 10, max config naks: 10
    max terminate requests: 3, retransmit interval: 3
  IPCP parameters:-
    max config requests: 10, max config naks: 10
    max terminate requests: 3, retransmit interval: 3
  use count: 0

Deleted ppp profile one
}

test ppp_profile-2.24 { Create ppp profile lcp_echo_interval= } \
    { l2tpdRunning && pppProfile } \
    { \
	clearResult
	l2tpConfig test log message=ppp_profile-2.24
	l2tpConfig ppp profile create profile_name=one lcp_echo_interval=42
	l2tpConfig ppp profile show profile_name=one
	l2tpConfig ppp profile delete profile_name=one
    } \
    {

Created ppp profile one
Ppp profile one
  trace flags: PROTOCOL FSM API AVP AVPHIDE AVPDATA FUNC XPRT DATA PPP SYSTEM
  mru: 1500, mtu: 1500, mode: SYNC|ASYNC
  allowed authentications: PAP CHAP MSCHAP MSCHAPv2 EAP 
  max connect time: 0, max failure count: 10, idle timeout: 0
  multilink: NO
  IP parameters:-
    local address: NOT SET, peer address: NOT SET
    dns addresses: NOT SET / NOT SET
    wins addresses: NOT SET / NOT SET
    use radius: NO
  PAP parameters:-
    max auth requests: 10, restart interval: 3, timeout: 0
  CHAP parameters:-
    interval: 10, max challenge: 10, restart: 3
  LCP parameters:-
    echo failure count: 0, echo interval: 42
    max config requests: 10, max config naks: 10
    max terminate requests: 3, retransmit interval: 3
  IPCP parameters:-
    max config requests: 10, max config naks: 10
    max terminate requests: 3, retransmit interval: 3
  use count: 0

Deleted ppp profile one
}

test ppp_profile-2.25 { Create ppp profile lcp_max_config_requests= } \
    { l2tpdRunning && pppProfile } \
    { \
	clearResult
	l2tpConfig test log message=ppp_profile-2.25
	l2tpConfig ppp profile create profile_name=one lcp_max_config_requests=42
	l2tpConfig ppp profile show profile_name=one
	l2tpConfig ppp profile delete profile_name=one
    } \
    {

Created ppp profile one
Ppp profile one
  trace flags: PROTOCOL FSM API AVP AVPHIDE AVPDATA FUNC XPRT DATA PPP SYSTEM
  mru: 1500, mtu: 1500, mode: SYNC|ASYNC
  allowed authentications: PAP CHAP MSCHAP MSCHAPv2 EAP 
  max connect time: 0, max failure count: 10, idle timeout: 0
  multilink: NO
  IP parameters:-
    local address: NOT SET, peer address: NOT SET
    dns addresses: NOT SET / NOT SET
    wins addresses: NOT SET / NOT SET
    use radius: NO
  PAP parameters:-
    max auth requests: 10, restart interval: 3, timeout: 0
  CHAP parameters:-
    interval: 10, max challenge: 10, restart: 3
  LCP parameters:-
    echo failure count: 0, echo interval: 0
    max config requests: 42, max config naks: 10
    max terminate requests: 3, retransmit interval: 3
  IPCP parameters:-
    max config requests: 10, max config naks: 10
    max terminate requests: 3, retransmit interval: 3
  use count: 0

Deleted ppp profile one
}

test ppp_profile-2.26 { Create ppp profile lcp_max_config_naks= } \
    { l2tpdRunning && pppProfile } \
    { \
	clearResult
	l2tpConfig test log message=ppp_profile-2.26
	l2tpConfig ppp profile create profile_name=one lcp_max_config_naks=42
	l2tpConfig ppp profile show profile_name=one
	l2tpConfig ppp profile delete profile_name=one
    } \
    {

Created ppp profile one
Ppp profile one
  trace flags: PROTOCOL FSM API AVP AVPHIDE AVPDATA FUNC XPRT DATA PPP SYSTEM
  mru: 1500, mtu: 1500, mode: SYNC|ASYNC
  allowed authentications: PAP CHAP MSCHAP MSCHAPv2 EAP 
  max connect time: 0, max failure count: 10, idle timeout: 0
  multilink: NO
  IP parameters:-
    local address: NOT SET, peer address: NOT SET
    dns addresses: NOT SET / NOT SET
    wins addresses: NOT SET / NOT SET
    use radius: NO
  PAP parameters:-
    max auth requests: 10, restart interval: 3, timeout: 0
  CHAP parameters:-
    interval: 10, max challenge: 10, restart: 3
  LCP parameters:-
    echo failure count: 0, echo interval: 0
    max config requests: 10, max config naks: 42
    max terminate requests: 3, retransmit interval: 3
  IPCP parameters:-
    max config requests: 10, max config naks: 10
    max terminate requests: 3, retransmit interval: 3
  use count: 0

Deleted ppp profile one
}

test ppp_profile-2.27 { Create ppp profile lcp_max_terminate_requests= } \
    { l2tpdRunning && pppProfile } \
    { \
	clearResult
	l2tpConfig test log message=ppp_profile-2.27
	l2tpConfig ppp profile create profile_name=one lcp_max_terminate_requests=42
	l2tpConfig ppp profile show profile_name=one
	l2tpConfig ppp profile delete profile_name=one
    } \
    {

Created ppp profile one
Ppp profile one
  trace flags: PROTOCOL FSM API AVP AVPHIDE AVPDATA FUNC XPRT DATA PPP SYSTEM
  mru: 1500, mtu: 1500, mode: SYNC|ASYNC
  allowed authentications: PAP CHAP MSCHAP MSCHAPv2 EAP 
  max connect time: 0, max failure count: 10, idle timeout: 0
  multilink: NO
  IP parameters:-
    local address: NOT SET, peer address: NOT SET
    dns addresses: NOT SET / NOT SET
    wins addresses: NOT SET / NOT SET
    use radius: NO
  PAP parameters:-
    max auth requests: 10, restart interval: 3, timeout: 0
  CHAP parameters:-
    interval: 10, max challenge: 10, restart: 3
  LCP parameters:-
    echo failure count: 0, echo interval: 0
    max config requests: 10, max config naks: 10
    max terminate requests: 42, retransmit interval: 3
  IPCP parameters:-
    max config requests: 10, max config naks: 10
    max terminate requests: 3, retransmit interval: 3
  use count: 0

Deleted ppp profile one
}

test ppp_profile-2.28 { Create ppp profile lcp_retransmit_interval= } \
    { l2tpdRunning && pppProfile } \
    { \
	clearResult
	l2tpConfig test log message=ppp_profile-2.28
	l2tpConfig ppp profile create profile_name=one lcp_retransmit_interval=42
	l2tpConfig ppp profile show profile_name=one
	l2tpConfig ppp profile delete profile_name=one
    } \
    {

Created ppp profile one
Ppp profile one
  trace flags: PROTOCOL FSM API AVP AVPHIDE AVPDATA FUNC XPRT DATA PPP SYSTEM
  mru: 1500, mtu: 1500, mode: SYNC|ASYNC
  allowed authentications: PAP CHAP MSCHAP MSCHAPv2 EAP 
  max connect time: 0, max failure count: 10, idle timeout: 0
  multilink: NO
  IP parameters:-
    local address: NOT SET, peer address: NOT SET
    dns addresses: NOT SET / NOT SET
    wins addresses: NOT SET / NOT SET
    use radius: NO
  PAP parameters:-
    max auth requests: 10, restart interval: 3, timeout: 0
  CHAP parameters:-
    interval: 10, max challenge: 10, restart: 3
  LCP parameters:-
    echo failure count: 0, echo interval: 0
    max config requests: 10, max config naks: 10
    max terminate requests: 3, retransmit interval: 42
  IPCP parameters:-
    max config requests: 10, max config naks: 10
    max terminate requests: 3, retransmit interval: 3
  use count: 0

Deleted ppp profile one
}

test ppp_profile-2.29 { Create ppp profile max_connect_time= } \
    { l2tpdRunning && pppProfile } \
    { \
	clearResult
	l2tpConfig test log message=ppp_profile-2.29
	l2tpConfig ppp profile create profile_name=one max_connect_time=42
	l2tpConfig ppp profile show profile_name=one
	l2tpConfig ppp profile delete profile_name=one
    } \
    {

Created ppp profile one
Ppp profile one
  trace flags: PROTOCOL FSM API AVP AVPHIDE AVPDATA FUNC XPRT DATA PPP SYSTEM
  mru: 1500, mtu: 1500, mode: SYNC|ASYNC
  allowed authentications: PAP CHAP MSCHAP MSCHAPv2 EAP 
  max connect time: 42, max failure count: 10, idle timeout: 0
  multilink: NO
  IP parameters:-
    local address: NOT SET, peer address: NOT SET
    dns addresses: NOT SET / NOT SET
    wins addresses: NOT SET / NOT SET
    use radius: NO
  PAP parameters:-
    max auth requests: 10, restart interval: 3, timeout: 0
  CHAP parameters:-
    interval: 10, max challenge: 10, restart: 3
  LCP parameters:-
    echo failure count: 0, echo interval: 0
    max config requests: 10, max config naks: 10
    max terminate requests: 3, retransmit interval: 3
  IPCP parameters:-
    max config requests: 10, max config naks: 10
    max terminate requests: 3, retransmit interval: 3
  use count: 0

Deleted ppp profile one
}

test ppp_profile-2.30 { Create ppp profile local_ipaddr= } \
    { l2tpdRunning && pppProfile } \
    { \
	clearResult
	l2tpConfig test log message=ppp_profile-2.30
	l2tpConfig ppp profile create profile_name=one local_ipaddr=10.1.2.3
	l2tpConfig ppp profile show profile_name=one
	l2tpConfig ppp profile delete profile_name=one
    } \
    {

Created ppp profile one
Ppp profile one
  trace flags: PROTOCOL FSM API AVP AVPHIDE AVPDATA FUNC XPRT DATA PPP SYSTEM
  mru: 1500, mtu: 1500, mode: SYNC|ASYNC
  allowed authentications: PAP CHAP MSCHAP MSCHAPv2 EAP 
  max connect time: 0, max failure count: 10, idle timeout: 0
  multilink: NO
  IP parameters:-
    local address: 10.1.2.3, peer address: NOT SET
    dns addresses: NOT SET / NOT SET
    wins addresses: NOT SET / NOT SET
    use radius: NO
  PAP parameters:-
    max auth requests: 10, restart interval: 3, timeout: 0
  CHAP parameters:-
    interval: 10, max challenge: 10, restart: 3
  LCP parameters:-
    echo failure count: 0, echo interval: 0
    max config requests: 10, max config naks: 10
    max terminate requests: 3, retransmit interval: 3
  IPCP parameters:-
    max config requests: 10, max config naks: 10
    max terminate requests: 3, retransmit interval: 3
  use count: 0

Deleted ppp profile one
}

test ppp_profile-2.31 { Create ppp profile remote_ipaddr= } \
    { l2tpdRunning && pppProfile } \
    { \
	clearResult
	l2tpConfig test log message=ppp_profile-2.31
	l2tpConfig ppp profile create profile_name=one remote_ipaddr=10.1.2.3
	l2tpConfig ppp profile show profile_name=one
	l2tpConfig ppp profile delete profile_name=one
    } \
    {

Created ppp profile one
Ppp profile one
  trace flags: PROTOCOL FSM API AVP AVPHIDE AVPDATA FUNC XPRT DATA PPP SYSTEM
  mru: 1500, mtu: 1500, mode: SYNC|ASYNC
  allowed authentications: PAP CHAP MSCHAP MSCHAPv2 EAP 
  max connect time: 0, max failure count: 10, idle timeout: 0
  multilink: NO
  IP parameters:-
    local address: NOT SET, peer address: 10.1.2.3
    dns addresses: NOT SET / NOT SET
    wins addresses: NOT SET / NOT SET
    use radius: NO
  PAP parameters:-
    max auth requests: 10, restart interval: 3, timeout: 0
  CHAP parameters:-
    interval: 10, max challenge: 10, restart: 3
  LCP parameters:-
    echo failure count: 0, echo interval: 0
    max config requests: 10, max config naks: 10
    max terminate requests: 3, retransmit interval: 3
  IPCP parameters:-
    max config requests: 10, max config naks: 10
    max terminate requests: 3, retransmit interval: 3
  use count: 0

Deleted ppp profile one
}

test ppp_profile-2.32 { Create ppp profile dns_ipaddr_pri= } \
    { l2tpdRunning && pppProfile } \
    { \
	clearResult
	l2tpConfig test log message=ppp_profile-2.32
	l2tpConfig ppp profile create profile_name=one dns_ipaddr_pri=10.1.2.3
	l2tpConfig ppp profile show profile_name=one
	l2tpConfig ppp profile delete profile_name=one
    } \
    {

Created ppp profile one
Ppp profile one
  trace flags: PROTOCOL FSM API AVP AVPHIDE AVPDATA FUNC XPRT DATA PPP SYSTEM
  mru: 1500, mtu: 1500, mode: SYNC|ASYNC
  allowed authentications: PAP CHAP MSCHAP MSCHAPv2 EAP 
  max connect time: 0, max failure count: 10, idle timeout: 0
  multilink: NO
  IP parameters:-
    local address: NOT SET, peer address: NOT SET
    dns addresses: 10.1.2.3 / NOT SET
    wins addresses: NOT SET / NOT SET
    use radius: NO
  PAP parameters:-
    max auth requests: 10, restart interval: 3, timeout: 0
  CHAP parameters:-
    interval: 10, max challenge: 10, restart: 3
  LCP parameters:-
    echo failure count: 0, echo interval: 0
    max config requests: 10, max config naks: 10
    max terminate requests: 3, retransmit interval: 3
  IPCP parameters:-
    max config requests: 10, max config naks: 10
    max terminate requests: 3, retransmit interval: 3
  use count: 0

Deleted ppp profile one
}

test ppp_profile-2.33 { Create ppp profile dns_ipaddr_sec= } \
    { l2tpdRunning && pppProfile } \
    { \
	clearResult
	l2tpConfig test log message=ppp_profile-2.33
	l2tpConfig ppp profile create profile_name=one dns_ipaddr_sec=10.1.2.3
	l2tpConfig ppp profile show profile_name=one
	l2tpConfig ppp profile delete profile_name=one
    } \
    {

Created ppp profile one
Ppp profile one
  trace flags: PROTOCOL FSM API AVP AVPHIDE AVPDATA FUNC XPRT DATA PPP SYSTEM
  mru: 1500, mtu: 1500, mode: SYNC|ASYNC
  allowed authentications: PAP CHAP MSCHAP MSCHAPv2 EAP 
  max connect time: 0, max failure count: 10, idle timeout: 0
  multilink: NO
  IP parameters:-
    local address: NOT SET, peer address: NOT SET
    dns addresses: NOT SET / 10.1.2.3
    wins addresses: NOT SET / NOT SET
    use radius: NO
  PAP parameters:-
    max auth requests: 10, restart interval: 3, timeout: 0
  CHAP parameters:-
    interval: 10, max challenge: 10, restart: 3
  LCP parameters:-
    echo failure count: 0, echo interval: 0
    max config requests: 10, max config naks: 10
    max terminate requests: 3, retransmit interval: 3
  IPCP parameters:-
    max config requests: 10, max config naks: 10
    max terminate requests: 3, retransmit interval: 3
  use count: 0

Deleted ppp profile one
}

test ppp_profile-2.34 { Create ppp profile wins_ipaddr_pri= } \
    { l2tpdRunning && pppProfile } \
    { \
	clearResult
	l2tpConfig test log message=ppp_profile-2.34
	l2tpConfig ppp profile create profile_name=one wins_ipaddr_pri=10.1.2.3
	l2tpConfig ppp profile show profile_name=one
	l2tpConfig ppp profile delete profile_name=one
    } \
    {

Created ppp profile one
Ppp profile one
  trace flags: PROTOCOL FSM API AVP AVPHIDE AVPDATA FUNC XPRT DATA PPP SYSTEM
  mru: 1500, mtu: 1500, mode: SYNC|ASYNC
  allowed authentications: PAP CHAP MSCHAP MSCHAPv2 EAP 
  max connect time: 0, max failure count: 10, idle timeout: 0
  multilink: NO
  IP parameters:-
    local address: NOT SET, peer address: NOT SET
    dns addresses: NOT SET / NOT SET
    wins addresses: 10.1.2.3 / NOT SET
    use radius: NO
  PAP parameters:-
    max auth requests: 10, restart interval: 3, timeout: 0
  CHAP parameters:-
    interval: 10, max challenge: 10, restart: 3
  LCP parameters:-
    echo failure count: 0, echo interval: 0
    max config requests: 10, max config naks: 10
    max terminate requests: 3, retransmit interval: 3
  IPCP parameters:-
    max config requests: 10, max config naks: 10
    max terminate requests: 3, retransmit interval: 3
  use count: 0

Deleted ppp profile one
}

test ppp_profile-2.35 { Create ppp profile wins_ipaddr_sec= } \
    { l2tpdRunning && pppProfile } \
    { \
	clearResult
	l2tpConfig test log message=ppp_profile-2.35
	l2tpConfig ppp profile create profile_name=one wins_ipaddr_sec=10.1.2.3
	l2tpConfig ppp profile show profile_name=one
	l2tpConfig ppp profile delete profile_name=one
    } \
    {

Created ppp profile one
Ppp profile one
  trace flags: PROTOCOL FSM API AVP AVPHIDE AVPDATA FUNC XPRT DATA PPP SYSTEM
  mru: 1500, mtu: 1500, mode: SYNC|ASYNC
  allowed authentications: PAP CHAP MSCHAP MSCHAPv2 EAP 
  max connect time: 0, max failure count: 10, idle timeout: 0
  multilink: NO
  IP parameters:-
    local address: NOT SET, peer address: NOT SET
    dns addresses: NOT SET / NOT SET
    wins addresses: NOT SET / 10.1.2.3
    use radius: NO
  PAP parameters:-
    max auth requests: 10, restart interval: 3, timeout: 0
  CHAP parameters:-
    interval: 10, max challenge: 10, restart: 3
  LCP parameters:-
    echo failure count: 0, echo interval: 0
    max config requests: 10, max config naks: 10
    max terminate requests: 3, retransmit interval: 3
  IPCP parameters:-
    max config requests: 10, max config naks: 10
    max terminate requests: 3, retransmit interval: 3
  use count: 0

Deleted ppp profile one
}

test ppp_profile-2.36 { Create ppp profile ip_pool_name= } \
    { l2tpdRunning && pppProfile } \
    { \
	clearResult
	l2tpConfig test log message=ppp_profile-2.36
	l2tpConfig ppp profile create profile_name=one ip_pool_name=wibble
	l2tpConfig ppp profile show profile_name=one
	l2tpConfig ppp profile delete profile_name=one
    } \
    {

Created ppp profile one
Ppp profile one
  trace flags: PROTOCOL FSM API AVP AVPHIDE AVPDATA FUNC XPRT DATA PPP SYSTEM
  mru: 1500, mtu: 1500, mode: SYNC|ASYNC
  allowed authentications: PAP CHAP MSCHAP MSCHAPv2 EAP 
  max connect time: 0, max failure count: 10, idle timeout: 0
  multilink: NO
  IP parameters:-
    local address: NOT SET, peer address: NOT SET
    dns addresses: NOT SET / NOT SET
    wins addresses: NOT SET / NOT SET
    ip pool name: wibble
    use radius: NO
  PAP parameters:-
    max auth requests: 10, restart interval: 3, timeout: 0
  CHAP parameters:-
    interval: 10, max challenge: 10, restart: 3
  LCP parameters:-
    echo failure count: 0, echo interval: 0
    max config requests: 10, max config naks: 10
    max terminate requests: 3, retransmit interval: 3
  IPCP parameters:-
    max config requests: 10, max config naks: 10
    max terminate requests: 3, retransmit interval: 3
  use count: 0

Deleted ppp profile one
}

test ppp_profile-2.37 { Create ppp profile use_radius= } \
    { l2tpdRunning && pppProfile } \
    { \
	clearResult
	l2tpConfig test log message=ppp_profile-2.37
	l2tpConfig ppp profile create profile_name=one use_radius=yes
	l2tpConfig ppp profile show profile_name=one
	l2tpConfig ppp profile delete profile_name=one
    } \
    {

Created ppp profile one
Ppp profile one
  trace flags: PROTOCOL FSM API AVP AVPHIDE AVPDATA FUNC XPRT DATA PPP SYSTEM
  mru: 1500, mtu: 1500, mode: SYNC|ASYNC
  allowed authentications: PAP CHAP MSCHAP MSCHAPv2 EAP 
  max connect time: 0, max failure count: 10, idle timeout: 0
  multilink: NO
  IP parameters:-
    local address: NOT SET, peer address: NOT SET
    dns addresses: NOT SET / NOT SET
    wins addresses: NOT SET / NOT SET
    use radius: YES
  PAP parameters:-
    max auth requests: 10, restart interval: 3, timeout: 0
  CHAP parameters:-
    interval: 10, max challenge: 10, restart: 3
  LCP parameters:-
    echo failure count: 0, echo interval: 0
    max config requests: 10, max config naks: 10
    max terminate requests: 3, retransmit interval: 3
  IPCP parameters:-
    max config requests: 10, max config naks: 10
    max terminate requests: 3, retransmit interval: 3
  use count: 0

Deleted ppp profile one
}

test ppp_profile-2.38 { Create ppp profile radius_hint= } \
    { l2tpdRunning && pppProfile } \
    { \
	clearResult
	l2tpConfig test log message=ppp_profile-2.38
	l2tpConfig ppp profile create profile_name=one use_radius=yes radius_hint=wibble
	l2tpConfig ppp profile show profile_name=one
	l2tpConfig ppp profile delete profile_name=one
    } \
    {

Created ppp profile one
Ppp profile one
  trace flags: PROTOCOL FSM API AVP AVPHIDE AVPDATA FUNC XPRT DATA PPP SYSTEM
  mru: 1500, mtu: 1500, mode: SYNC|ASYNC
  allowed authentications: PAP CHAP MSCHAP MSCHAPv2 EAP 
  max connect time: 0, max failure count: 10, idle timeout: 0
  multilink: NO
  IP parameters:-
    local address: NOT SET, peer address: NOT SET
    dns addresses: NOT SET / NOT SET
    wins addresses: NOT SET / NOT SET
    use radius: YES
    radius hint: wibble
  PAP parameters:-
    max auth requests: 10, restart interval: 3, timeout: 0
  CHAP parameters:-
    interval: 10, max challenge: 10, restart: 3
  LCP parameters:-
    echo failure count: 0, echo interval: 0
    max config requests: 10, max config naks: 10
    max terminate requests: 3, retransmit interval: 3
  IPCP parameters:-
    max config requests: 10, max config naks: 10
    max terminate requests: 3, retransmit interval: 3
  use count: 0

Deleted ppp profile one
}

test ppp_profile-2.39 { Create ppp profile multilink= } \
    { l2tpdRunning && pppProfile } \
    { \
	clearResult
	l2tpConfig test log message=ppp_profile-2.39
	l2tpConfig ppp profile create profile_name=one multilink=yes
	l2tpConfig ppp profile show profile_name=one
	l2tpConfig ppp profile delete profile_name=one
    } \
    {

Created ppp profile one
Ppp profile one
  trace flags: PROTOCOL FSM API AVP AVPHIDE AVPDATA FUNC XPRT DATA PPP SYSTEM
  mru: 1500, mtu: 1500, mode: SYNC|ASYNC
  allowed authentications: PAP CHAP MSCHAP MSCHAPv2 EAP 
  max connect time: 0, max failure count: 10, idle timeout: 0
  multilink: YES
  IP parameters:-
    local address: NOT SET, peer address: NOT SET
    dns addresses: NOT SET / NOT SET
    wins addresses: NOT SET / NOT SET
    use radius: NO
  PAP parameters:-
    max auth requests: 10, restart interval: 3, timeout: 0
  CHAP parameters:-
    interval: 10, max challenge: 10, restart: 3
  LCP parameters:-
    echo failure count: 0, echo interval: 0
    max config requests: 10, max config naks: 10
    max terminate requests: 3, retransmit interval: 3
  IPCP parameters:-
    max config requests: 10, max config naks: 10
    max terminate requests: 3, retransmit interval: 3
  use count: 0

Deleted ppp profile one
}

test ppp_profile-2.40 { Complex ppp profile create with all args } \
    { l2tpdRunning && pppProfile } \
    { \
	clearResult
	l2tpConfig test log message=ppp_profile-2.39
	l2tpConfig ppp profile create profile_name=one \
	  trace_flags=15 \
	  asyncmap=0x42 \
	  mtu=42 \
	  mru=42 \
	  sync_mode=async \
	  auth_pap=no \
	  auth_chap=no \
	  auth_mschapv1=no \
	  auth_mschapv2=no \
	  auth_eap=no \
	  auth_none=yes \
	  chap_interval=42 \
	  chap_max_challenge=42 \
	  chap_restart=42 \
	  pap_max_auth_requests=42 \
	  pap_restart_interval=42 \
	  pap_timeout=42 \
	  idle_timeout=42 \
	  ipcp_max_config_requests=42 \
	  ipcp_max_config_naks=42 \
	  ipcp_max_terminate_requests=42 \
	  ipcp_retransmit_interval=42 \
	  lcp_echo_failure_count=42 \
	  lcp_echo_interval=42 \
	  lcp_max_config_requests=42 \
	  lcp_max_config_naks=42 \
	  lcp_max_terminate_requests=42 \
	  lcp_retransmit_interval=42 \
	  max_connect_time=42 \
	  max_failure_count=42 \
	  local_ipaddr=10.0.0.1 \
	  remote_ipaddr=10.0.0.2 \
	  dns_ipaddr_pri=10.0.0.3 \
	  dns_ipaddr_sec=10.0.0.4 \
	  wins_ipaddr_pri=10.0.0.5 \
	  wins_ipaddr_sec=10.0.0.6 \
	  ip_pool_name=wibble \
	  use_radius=yes \
	  multilink=yes \
	  radius_hint=wibble
	l2tpConfig ppp profile show profile_name=one
	l2tpConfig ppp profile delete profile_name=one
    } \
    {

Created ppp profile one
Ppp profile one
  trace flags: PROTOCOL FSM API AVP
  mru: 42, mtu: 42, mode: ASYNC
  allowed authentications: NOAUTH 
  max connect time: 42, max failure count: 42, idle timeout: 42
  asyncmap: 0x42
  multilink: YES
  IP parameters:-
    local address: 10.0.0.1, peer address: 10.0.0.2
    dns addresses: 10.0.0.3 / 10.0.0.4
    wins addresses: 10.0.0.5 / 10.0.0.6
    ip pool name: wibble
    use radius: YES
    radius hint: wibble
  PAP parameters:-
    max auth requests: 42, restart interval: 42, timeout: 42
  CHAP parameters:-
    interval: 42, max challenge: 42, restart: 42
  LCP parameters:-
    echo failure count: 42, echo interval: 42
    max config requests: 42, max config naks: 42
    max terminate requests: 42, retransmit interval: 42
  IPCP parameters:-
    max config requests: 42, max config naks: 42
    max terminate requests: 42, retransmit interval: 42
  use count: 0

Deleted ppp profile one
}

############################################################################
# Tests 3.* - modify parameters
############################################################################

test ppp_profile-3.1 { Modify ppp profile idle_timeout= } \
    { l2tpdRunning && pppProfile } \
    { \
	clearResult
	l2tpConfig test log message=ppp_profile-3.1
	l2tpConfig ppp profile create profile_name=one 
	l2tpConfig ppp profile modify profile_name=one idle_timeout=59
	l2tpConfig ppp profile show profile_name=one
	l2tpConfig ppp profile delete profile_name=one
    } \
    {

Created ppp profile one
Modified ppp profile one
Ppp profile one
  trace flags: PROTOCOL FSM API AVP AVPHIDE AVPDATA FUNC XPRT DATA PPP SYSTEM
  mru: 1500, mtu: 1500, mode: SYNC|ASYNC
  allowed authentications: PAP CHAP MSCHAP MSCHAPv2 EAP 
  max connect time: 0, max failure count: 10, idle timeout: 59
  multilink: NO
  IP parameters:-
    local address: NOT SET, peer address: NOT SET
    dns addresses: NOT SET / NOT SET
    wins addresses: NOT SET / NOT SET
    use radius: NO
  PAP parameters:-
    max auth requests: 10, restart interval: 3, timeout: 0
  CHAP parameters:-
    interval: 10, max challenge: 10, restart: 3
  LCP parameters:-
    echo failure count: 0, echo interval: 0
    max config requests: 10, max config naks: 10
    max terminate requests: 3, retransmit interval: 3
  IPCP parameters:-
    max config requests: 10, max config naks: 10
    max terminate requests: 3, retransmit interval: 3
  use count: 0

Deleted ppp profile one
}

test ppp_profile-3.2 { Modify ppp profile trace_flags= } \
    { l2tpdRunning && pppProfile } \
    { \
	clearResult
	l2tpConfig test log message=ppp_profile-3.2
	l2tpConfig ppp profile create profile_name=one
	l2tpConfig ppp profile modify profile_name=one trace_flags=7
	l2tpConfig ppp profile show profile_name=one
	l2tpConfig ppp profile delete profile_name=one
    } \
    {

Created ppp profile one
Modified ppp profile one
Ppp profile one
  trace flags: PROTOCOL FSM API
  mru: 1500, mtu: 1500, mode: SYNC|ASYNC
  allowed authentications: PAP CHAP MSCHAP MSCHAPv2 EAP 
  max connect time: 0, max failure count: 10, idle timeout: 0
  multilink: NO
  IP parameters:-
    local address: NOT SET, peer address: NOT SET
    dns addresses: NOT SET / NOT SET
    wins addresses: NOT SET / NOT SET
    use radius: NO
  PAP parameters:-
    max auth requests: 10, restart interval: 3, timeout: 0
  CHAP parameters:-
    interval: 10, max challenge: 10, restart: 3
  LCP parameters:-
    echo failure count: 0, echo interval: 0
    max config requests: 10, max config naks: 10
    max terminate requests: 3, retransmit interval: 3
  IPCP parameters:-
    max config requests: 10, max config naks: 10
    max terminate requests: 3, retransmit interval: 3
  use count: 0

Deleted ppp profile one
}

test ppp_profile-3.3 { Modify ppp profile asyncmap= } \
    { l2tpdRunning && pppProfile } \
    { \
	clearResult
	l2tpConfig test log message=ppp_profile-3.3
	l2tpConfig ppp profile create profile_name=one
	l2tpConfig ppp profile modify profile_name=one asyncmap=0x42
	l2tpConfig ppp profile show profile_name=one
	l2tpConfig ppp profile delete profile_name=one
    } \
    {

Created ppp profile one
Modified ppp profile one
Ppp profile one
  trace flags: PROTOCOL FSM API AVP AVPHIDE AVPDATA FUNC XPRT DATA PPP SYSTEM
  mru: 1500, mtu: 1500, mode: SYNC|ASYNC
  allowed authentications: PAP CHAP MSCHAP MSCHAPv2 EAP 
  max connect time: 0, max failure count: 10, idle timeout: 0
  asyncmap: 0x42
  multilink: NO
  IP parameters:-
    local address: NOT SET, peer address: NOT SET
    dns addresses: NOT SET / NOT SET
    wins addresses: NOT SET / NOT SET
    use radius: NO
  PAP parameters:-
    max auth requests: 10, restart interval: 3, timeout: 0
  CHAP parameters:-
    interval: 10, max challenge: 10, restart: 3
  LCP parameters:-
    echo failure count: 0, echo interval: 0
    max config requests: 10, max config naks: 10
    max terminate requests: 3, retransmit interval: 3
  IPCP parameters:-
    max config requests: 10, max config naks: 10
    max terminate requests: 3, retransmit interval: 3
  use count: 0

Deleted ppp profile one
}

test ppp_profile-3.4 { Modify ppp profile mtu= } \
    { l2tpdRunning && pppProfile } \
    { \
	clearResult
	l2tpConfig test log message=ppp_profile-3.4
	l2tpConfig ppp profile create profile_name=one
	l2tpConfig ppp profile modify profile_name=one mtu=42
	l2tpConfig ppp profile show profile_name=one
	l2tpConfig ppp profile delete profile_name=one
    } \
    {

Created ppp profile one
Modified ppp profile one
Ppp profile one
  trace flags: PROTOCOL FSM API AVP AVPHIDE AVPDATA FUNC XPRT DATA PPP SYSTEM
  mru: 1500, mtu: 42, mode: SYNC|ASYNC
  allowed authentications: PAP CHAP MSCHAP MSCHAPv2 EAP 
  max connect time: 0, max failure count: 10, idle timeout: 0
  multilink: NO
  IP parameters:-
    local address: NOT SET, peer address: NOT SET
    dns addresses: NOT SET / NOT SET
    wins addresses: NOT SET / NOT SET
    use radius: NO
  PAP parameters:-
    max auth requests: 10, restart interval: 3, timeout: 0
  CHAP parameters:-
    interval: 10, max challenge: 10, restart: 3
  LCP parameters:-
    echo failure count: 0, echo interval: 0
    max config requests: 10, max config naks: 10
    max terminate requests: 3, retransmit interval: 3
  IPCP parameters:-
    max config requests: 10, max config naks: 10
    max terminate requests: 3, retransmit interval: 3
  use count: 0

Deleted ppp profile one
}

test ppp_profile-3.5 { Modify ppp profile mru= } \
    { l2tpdRunning && pppProfile } \
    { \
	clearResult
	l2tpConfig test log message=ppp_profile-3.5
	l2tpConfig ppp profile create profile_name=one
	l2tpConfig ppp profile modify profile_name=one mru=42
	l2tpConfig ppp profile show profile_name=one
	l2tpConfig ppp profile delete profile_name=one
    } \
    {

Created ppp profile one
Modified ppp profile one
Ppp profile one
  trace flags: PROTOCOL FSM API AVP AVPHIDE AVPDATA FUNC XPRT DATA PPP SYSTEM
  mru: 42, mtu: 1500, mode: SYNC|ASYNC
  allowed authentications: PAP CHAP MSCHAP MSCHAPv2 EAP 
  max connect time: 0, max failure count: 10, idle timeout: 0
  multilink: NO
  IP parameters:-
    local address: NOT SET, peer address: NOT SET
    dns addresses: NOT SET / NOT SET
    wins addresses: NOT SET / NOT SET
    use radius: NO
  PAP parameters:-
    max auth requests: 10, restart interval: 3, timeout: 0
  CHAP parameters:-
    interval: 10, max challenge: 10, restart: 3
  LCP parameters:-
    echo failure count: 0, echo interval: 0
    max config requests: 10, max config naks: 10
    max terminate requests: 3, retransmit interval: 3
  IPCP parameters:-
    max config requests: 10, max config naks: 10
    max terminate requests: 3, retransmit interval: 3
  use count: 0

Deleted ppp profile one
}

test ppp_profile-3.6 { Modify ppp profile sync_mode= } \
    { l2tpdRunning && pppProfile } \
    { \
	clearResult
	l2tpConfig test log message=ppp_profile-3.6
	l2tpConfig ppp profile create profile_name=one
	l2tpConfig ppp profile modify profile_name=one sync_mode=sync
	l2tpConfig ppp profile show profile_name=one
	l2tpConfig ppp profile delete profile_name=one
	l2tpConfig ppp profile create profile_name=one
	l2tpConfig ppp profile modify profile_name=one sync_mode=async
	l2tpConfig ppp profile show profile_name=one
	l2tpConfig ppp profile delete profile_name=one
	l2tpConfig ppp profile create profile_name=one
	l2tpConfig ppp profile modify profile_name=one sync_mode=any
	l2tpConfig ppp profile show profile_name=one
	l2tpConfig ppp profile delete profile_name=one
    } \
    {

Created ppp profile one
Modified ppp profile one
Ppp profile one
  trace flags: PROTOCOL FSM API AVP AVPHIDE AVPDATA FUNC XPRT DATA PPP SYSTEM
  mru: 1500, mtu: 1500, mode: SYNC
  allowed authentications: PAP CHAP MSCHAP MSCHAPv2 EAP 
  max connect time: 0, max failure count: 10, idle timeout: 0
  multilink: NO
  IP parameters:-
    local address: NOT SET, peer address: NOT SET
    dns addresses: NOT SET / NOT SET
    wins addresses: NOT SET / NOT SET
    use radius: NO
  PAP parameters:-
    max auth requests: 10, restart interval: 3, timeout: 0
  CHAP parameters:-
    interval: 10, max challenge: 10, restart: 3
  LCP parameters:-
    echo failure count: 0, echo interval: 0
    max config requests: 10, max config naks: 10
    max terminate requests: 3, retransmit interval: 3
  IPCP parameters:-
    max config requests: 10, max config naks: 10
    max terminate requests: 3, retransmit interval: 3
  use count: 0

Deleted ppp profile one
Created ppp profile one
Modified ppp profile one
Ppp profile one
  trace flags: PROTOCOL FSM API AVP AVPHIDE AVPDATA FUNC XPRT DATA PPP SYSTEM
  mru: 1500, mtu: 1500, mode: ASYNC
  allowed authentications: PAP CHAP MSCHAP MSCHAPv2 EAP 
  max connect time: 0, max failure count: 10, idle timeout: 0
  multilink: NO
  IP parameters:-
    local address: NOT SET, peer address: NOT SET
    dns addresses: NOT SET / NOT SET
    wins addresses: NOT SET / NOT SET
    use radius: NO
  PAP parameters:-
    max auth requests: 10, restart interval: 3, timeout: 0
  CHAP parameters:-
    interval: 10, max challenge: 10, restart: 3
  LCP parameters:-
    echo failure count: 0, echo interval: 0
    max config requests: 10, max config naks: 10
    max terminate requests: 3, retransmit interval: 3
  IPCP parameters:-
    max config requests: 10, max config naks: 10
    max terminate requests: 3, retransmit interval: 3
  use count: 0

Deleted ppp profile one
Created ppp profile one
Modified ppp profile one
Ppp profile one
  trace flags: PROTOCOL FSM API AVP AVPHIDE AVPDATA FUNC XPRT DATA PPP SYSTEM
  mru: 1500, mtu: 1500, mode: SYNC|ASYNC
  allowed authentications: PAP CHAP MSCHAP MSCHAPv2 EAP 
  max connect time: 0, max failure count: 10, idle timeout: 0
  multilink: NO
  IP parameters:-
    local address: NOT SET, peer address: NOT SET
    dns addresses: NOT SET / NOT SET
    wins addresses: NOT SET / NOT SET
    use radius: NO
  PAP parameters:-
    max auth requests: 10, restart interval: 3, timeout: 0
  CHAP parameters:-
    interval: 10, max challenge: 10, restart: 3
  LCP parameters:-
    echo failure count: 0, echo interval: 0
    max config requests: 10, max config naks: 10
    max terminate requests: 3, retransmit interval: 3
  IPCP parameters:-
    max config requests: 10, max config naks: 10
    max terminate requests: 3, retransmit interval: 3
  use count: 0

Deleted ppp profile one
}

test ppp_profile-3.7 { Modify ppp profile auth_pap= } \
    { l2tpdRunning && pppProfile } \
    { \
	clearResult
	l2tpConfig test log message=ppp_profile-3.7
	l2tpConfig ppp profile create profile_name=one
	l2tpConfig ppp profile modify profile_name=one auth_pap=no
	l2tpConfig ppp profile show profile_name=one
	l2tpConfig ppp profile delete profile_name=one
    } \
    {

Created ppp profile one
Modified ppp profile one
Ppp profile one
  trace flags: PROTOCOL FSM API AVP AVPHIDE AVPDATA FUNC XPRT DATA PPP SYSTEM
  mru: 1500, mtu: 1500, mode: SYNC|ASYNC
  allowed authentications: CHAP MSCHAP MSCHAPv2 EAP 
  max connect time: 0, max failure count: 10, idle timeout: 0
  multilink: NO
  IP parameters:-
    local address: NOT SET, peer address: NOT SET
    dns addresses: NOT SET / NOT SET
    wins addresses: NOT SET / NOT SET
    use radius: NO
  PAP parameters:-
    max auth requests: 10, restart interval: 3, timeout: 0
  CHAP parameters:-
    interval: 10, max challenge: 10, restart: 3
  LCP parameters:-
    echo failure count: 0, echo interval: 0
    max config requests: 10, max config naks: 10
    max terminate requests: 3, retransmit interval: 3
  IPCP parameters:-
    max config requests: 10, max config naks: 10
    max terminate requests: 3, retransmit interval: 3
  use count: 0

Deleted ppp profile one
}

test ppp_profile-3.8 { Modify ppp profile auth_chap= } \
    { l2tpdRunning && pppProfile } \
    { \
	clearResult
	l2tpConfig test log message=ppp_profile-3.8
	l2tpConfig ppp profile create profile_name=one
	l2tpConfig ppp profile modify profile_name=one auth_chap=no
	l2tpConfig ppp profile show profile_name=one
	l2tpConfig ppp profile delete profile_name=one
    } \
    {

Created ppp profile one
Modified ppp profile one
Ppp profile one
  trace flags: PROTOCOL FSM API AVP AVPHIDE AVPDATA FUNC XPRT DATA PPP SYSTEM
  mru: 1500, mtu: 1500, mode: SYNC|ASYNC
  allowed authentications: PAP MSCHAP MSCHAPv2 EAP 
  max connect time: 0, max failure count: 10, idle timeout: 0
  multilink: NO
  IP parameters:-
    local address: NOT SET, peer address: NOT SET
    dns addresses: NOT SET / NOT SET
    wins addresses: NOT SET / NOT SET
    use radius: NO
  PAP parameters:-
    max auth requests: 10, restart interval: 3, timeout: 0
  CHAP parameters:-
    interval: 10, max challenge: 10, restart: 3
  LCP parameters:-
    echo failure count: 0, echo interval: 0
    max config requests: 10, max config naks: 10
    max terminate requests: 3, retransmit interval: 3
  IPCP parameters:-
    max config requests: 10, max config naks: 10
    max terminate requests: 3, retransmit interval: 3
  use count: 0

Deleted ppp profile one
}

test ppp_profile-3.9 { Modify ppp profile auth_mschapv1= } \
    { l2tpdRunning && pppProfile } \
    { \
	clearResult
	l2tpConfig test log message=ppp_profile-3.9
	l2tpConfig ppp profile create profile_name=one
	l2tpConfig ppp profile modify profile_name=one auth_mschapv1=no
	l2tpConfig ppp profile show profile_name=one
	l2tpConfig ppp profile delete profile_name=one
    } \
    {

Created ppp profile one
Modified ppp profile one
Ppp profile one
  trace flags: PROTOCOL FSM API AVP AVPHIDE AVPDATA FUNC XPRT DATA PPP SYSTEM
  mru: 1500, mtu: 1500, mode: SYNC|ASYNC
  allowed authentications: PAP CHAP MSCHAPv2 EAP 
  max connect time: 0, max failure count: 10, idle timeout: 0
  multilink: NO
  IP parameters:-
    local address: NOT SET, peer address: NOT SET
    dns addresses: NOT SET / NOT SET
    wins addresses: NOT SET / NOT SET
    use radius: NO
  PAP parameters:-
    max auth requests: 10, restart interval: 3, timeout: 0
  CHAP parameters:-
    interval: 10, max challenge: 10, restart: 3
  LCP parameters:-
    echo failure count: 0, echo interval: 0
    max config requests: 10, max config naks: 10
    max terminate requests: 3, retransmit interval: 3
  IPCP parameters:-
    max config requests: 10, max config naks: 10
    max terminate requests: 3, retransmit interval: 3
  use count: 0

Deleted ppp profile one
}

test ppp_profile-3.10 { Modify ppp profile auth_mschapv2= } \
    { l2tpdRunning && pppProfile } \
    { \
	clearResult
	l2tpConfig test log message=ppp_profile-3.10
	l2tpConfig ppp profile create profile_name=one
	l2tpConfig ppp profile modify profile_name=one auth_mschapv2=no
	l2tpConfig ppp profile show profile_name=one
	l2tpConfig ppp profile delete profile_name=one
    } \
    {

Created ppp profile one
Modified ppp profile one
Ppp profile one
  trace flags: PROTOCOL FSM API AVP AVPHIDE AVPDATA FUNC XPRT DATA PPP SYSTEM
  mru: 1500, mtu: 1500, mode: SYNC|ASYNC
  allowed authentications: PAP CHAP MSCHAP EAP 
  max connect time: 0, max failure count: 10, idle timeout: 0
  multilink: NO
  IP parameters:-
    local address: NOT SET, peer address: NOT SET
    dns addresses: NOT SET / NOT SET
    wins addresses: NOT SET / NOT SET
    use radius: NO
  PAP parameters:-
    max auth requests: 10, restart interval: 3, timeout: 0
  CHAP parameters:-
    interval: 10, max challenge: 10, restart: 3
  LCP parameters:-
    echo failure count: 0, echo interval: 0
    max config requests: 10, max config naks: 10
    max terminate requests: 3, retransmit interval: 3
  IPCP parameters:-
    max config requests: 10, max config naks: 10
    max terminate requests: 3, retransmit interval: 3
  use count: 0

Deleted ppp profile one
}

test ppp_profile-3.11 { Modify ppp profile auth_eap= } \
    { l2tpdRunning && pppProfile } \
    { \
	clearResult
	l2tpConfig test log message=ppp_profile-3.11
	l2tpConfig ppp profile create profile_name=one
	l2tpConfig ppp profile modify profile_name=one auth_eap=no
	l2tpConfig ppp profile show profile_name=one
	l2tpConfig ppp profile delete profile_name=one
    } \
    {

Created ppp profile one
Modified ppp profile one
Ppp profile one
  trace flags: PROTOCOL FSM API AVP AVPHIDE AVPDATA FUNC XPRT DATA PPP SYSTEM
  mru: 1500, mtu: 1500, mode: SYNC|ASYNC
  allowed authentications: PAP CHAP MSCHAP MSCHAPv2 
  max connect time: 0, max failure count: 10, idle timeout: 0
  multilink: NO
  IP parameters:-
    local address: NOT SET, peer address: NOT SET
    dns addresses: NOT SET / NOT SET
    wins addresses: NOT SET / NOT SET
    use radius: NO
  PAP parameters:-
    max auth requests: 10, restart interval: 3, timeout: 0
  CHAP parameters:-
    interval: 10, max challenge: 10, restart: 3
  LCP parameters:-
    echo failure count: 0, echo interval: 0
    max config requests: 10, max config naks: 10
    max terminate requests: 3, retransmit interval: 3
  IPCP parameters:-
    max config requests: 10, max config naks: 10
    max terminate requests: 3, retransmit interval: 3
  use count: 0

Deleted ppp profile one
}

test ppp_profile-3.12 { Modify ppp profile auth_none= } \
    { l2tpdRunning && pppProfile } \
    { \
	clearResult
	l2tpConfig test log message=ppp_profile-3.12
	l2tpConfig ppp profile create profile_name=one
	l2tpConfig ppp profile modify profile_name=one auth_none=yes
	l2tpConfig ppp profile show profile_name=one
	l2tpConfig ppp profile delete profile_name=one
    } \
    {

Created ppp profile one
Modified ppp profile one
Ppp profile one
  trace flags: PROTOCOL FSM API AVP AVPHIDE AVPDATA FUNC XPRT DATA PPP SYSTEM
  mru: 1500, mtu: 1500, mode: SYNC|ASYNC
  allowed authentications: PAP CHAP MSCHAP MSCHAPv2 EAP NOAUTH 
  max connect time: 0, max failure count: 10, idle timeout: 0
  multilink: NO
  IP parameters:-
    local address: NOT SET, peer address: NOT SET
    dns addresses: NOT SET / NOT SET
    wins addresses: NOT SET / NOT SET
    use radius: NO
  PAP parameters:-
    max auth requests: 10, restart interval: 3, timeout: 0
  CHAP parameters:-
    interval: 10, max challenge: 10, restart: 3
  LCP parameters:-
    echo failure count: 0, echo interval: 0
    max config requests: 10, max config naks: 10
    max terminate requests: 3, retransmit interval: 3
  IPCP parameters:-
    max config requests: 10, max config naks: 10
    max terminate requests: 3, retransmit interval: 3
  use count: 0

Deleted ppp profile one
}

test ppp_profile-3.13 { Modify ppp profile chap_interval= } \
    { l2tpdRunning && pppProfile } \
    { \
	clearResult
	l2tpConfig test log message=ppp_profile-3.13
	l2tpConfig ppp profile create profile_name=one
	l2tpConfig ppp profile modify profile_name=one chap_interval=42
	l2tpConfig ppp profile show profile_name=one
	l2tpConfig ppp profile delete profile_name=one
    } \
    {

Created ppp profile one
Modified ppp profile one
Ppp profile one
  trace flags: PROTOCOL FSM API AVP AVPHIDE AVPDATA FUNC XPRT DATA PPP SYSTEM
  mru: 1500, mtu: 1500, mode: SYNC|ASYNC
  allowed authentications: PAP CHAP MSCHAP MSCHAPv2 EAP 
  max connect time: 0, max failure count: 10, idle timeout: 0
  multilink: NO
  IP parameters:-
    local address: NOT SET, peer address: NOT SET
    dns addresses: NOT SET / NOT SET
    wins addresses: NOT SET / NOT SET
    use radius: NO
  PAP parameters:-
    max auth requests: 10, restart interval: 3, timeout: 0
  CHAP parameters:-
    interval: 42, max challenge: 10, restart: 3
  LCP parameters:-
    echo failure count: 0, echo interval: 0
    max config requests: 10, max config naks: 10
    max terminate requests: 3, retransmit interval: 3
  IPCP parameters:-
    max config requests: 10, max config naks: 10
    max terminate requests: 3, retransmit interval: 3
  use count: 0

Deleted ppp profile one
}

test ppp_profile-3.14 { Modify ppp profile chap_max_challenge= } \
    { l2tpdRunning && pppProfile } \
    { \
	clearResult
	l2tpConfig test log message=ppp_profile-3.14
	l2tpConfig ppp profile create profile_name=one
	l2tpConfig ppp profile modify profile_name=one chap_max_challenge=42
	l2tpConfig ppp profile show profile_name=one
	l2tpConfig ppp profile delete profile_name=one
    } \
    {

Created ppp profile one
Modified ppp profile one
Ppp profile one
  trace flags: PROTOCOL FSM API AVP AVPHIDE AVPDATA FUNC XPRT DATA PPP SYSTEM
  mru: 1500, mtu: 1500, mode: SYNC|ASYNC
  allowed authentications: PAP CHAP MSCHAP MSCHAPv2 EAP 
  max connect time: 0, max failure count: 10, idle timeout: 0
  multilink: NO
  IP parameters:-
    local address: NOT SET, peer address: NOT SET
    dns addresses: NOT SET / NOT SET
    wins addresses: NOT SET / NOT SET
    use radius: NO
  PAP parameters:-
    max auth requests: 10, restart interval: 3, timeout: 0
  CHAP parameters:-
    interval: 10, max challenge: 42, restart: 3
  LCP parameters:-
    echo failure count: 0, echo interval: 0
    max config requests: 10, max config naks: 10
    max terminate requests: 3, retransmit interval: 3
  IPCP parameters:-
    max config requests: 10, max config naks: 10
    max terminate requests: 3, retransmit interval: 3
  use count: 0

Deleted ppp profile one
}

test ppp_profile-3.15 { Modify ppp profile chap_restart= } \
    { l2tpdRunning && pppProfile } \
    { \
	clearResult
	l2tpConfig test log message=ppp_profile-3.15
	l2tpConfig ppp profile create profile_name=one
	l2tpConfig ppp profile modify profile_name=one chap_restart=42
	l2tpConfig ppp profile show profile_name=one
	l2tpConfig ppp profile delete profile_name=one
    } \
    {

Created ppp profile one
Modified ppp profile one
Ppp profile one
  trace flags: PROTOCOL FSM API AVP AVPHIDE AVPDATA FUNC XPRT DATA PPP SYSTEM
  mru: 1500, mtu: 1500, mode: SYNC|ASYNC
  allowed authentications: PAP CHAP MSCHAP MSCHAPv2 EAP 
  max connect time: 0, max failure count: 10, idle timeout: 0
  multilink: NO
  IP parameters:-
    local address: NOT SET, peer address: NOT SET
    dns addresses: NOT SET / NOT SET
    wins addresses: NOT SET / NOT SET
    use radius: NO
  PAP parameters:-
    max auth requests: 10, restart interval: 3, timeout: 0
  CHAP parameters:-
    interval: 10, max challenge: 10, restart: 42
  LCP parameters:-
    echo failure count: 0, echo interval: 0
    max config requests: 10, max config naks: 10
    max terminate requests: 3, retransmit interval: 3
  IPCP parameters:-
    max config requests: 10, max config naks: 10
    max terminate requests: 3, retransmit interval: 3
  use count: 0

Deleted ppp profile one
}

test ppp_profile-3.16 { Modify ppp profile pap_max_auth_requests= } \
    { l2tpdRunning && pppProfile } \
    { \
	clearResult
	l2tpConfig test log message=ppp_profile-3.16
	l2tpConfig ppp profile create profile_name=one
	l2tpConfig ppp profile modify profile_name=one pap_max_auth_requests=42
	l2tpConfig ppp profile show profile_name=one
	l2tpConfig ppp profile delete profile_name=one
    } \
    {

Created ppp profile one
Modified ppp profile one
Ppp profile one
  trace flags: PROTOCOL FSM API AVP AVPHIDE AVPDATA FUNC XPRT DATA PPP SYSTEM
  mru: 1500, mtu: 1500, mode: SYNC|ASYNC
  allowed authentications: PAP CHAP MSCHAP MSCHAPv2 EAP 
  max connect time: 0, max failure count: 10, idle timeout: 0
  multilink: NO
  IP parameters:-
    local address: NOT SET, peer address: NOT SET
    dns addresses: NOT SET / NOT SET
    wins addresses: NOT SET / NOT SET
    use radius: NO
  PAP parameters:-
    max auth requests: 42, restart interval: 3, timeout: 0
  CHAP parameters:-
    interval: 10, max challenge: 10, restart: 3
  LCP parameters:-
    echo failure count: 0, echo interval: 0
    max config requests: 10, max config naks: 10
    max terminate requests: 3, retransmit interval: 3
  IPCP parameters:-
    max config requests: 10, max config naks: 10
    max terminate requests: 3, retransmit interval: 3
  use count: 0

Deleted ppp profile one
}

test ppp_profile-3.17 { Modify ppp profile pap_restart_interval= } \
    { l2tpdRunning && pppProfile } \
    { \
	clearResult
	l2tpConfig test log message=ppp_profile-3.17
	l2tpConfig ppp profile create profile_name=one
	l2tpConfig ppp profile modify profile_name=one pap_restart_interval=42
	l2tpConfig ppp profile show profile_name=one
	l2tpConfig ppp profile delete profile_name=one
    } \
    {

Created ppp profile one
Modified ppp profile one
Ppp profile one
  trace flags: PROTOCOL FSM API AVP AVPHIDE AVPDATA FUNC XPRT DATA PPP SYSTEM
  mru: 1500, mtu: 1500, mode: SYNC|ASYNC
  allowed authentications: PAP CHAP MSCHAP MSCHAPv2 EAP 
  max connect time: 0, max failure count: 10, idle timeout: 0
  multilink: NO
  IP parameters:-
    local address: NOT SET, peer address: NOT SET
    dns addresses: NOT SET / NOT SET
    wins addresses: NOT SET / NOT SET
    use radius: NO
  PAP parameters:-
    max auth requests: 10, restart interval: 42, timeout: 0
  CHAP parameters:-
    interval: 10, max challenge: 10, restart: 3
  LCP parameters:-
    echo failure count: 0, echo interval: 0
    max config requests: 10, max config naks: 10
    max terminate requests: 3, retransmit interval: 3
  IPCP parameters:-
    max config requests: 10, max config naks: 10
    max terminate requests: 3, retransmit interval: 3
  use count: 0

Deleted ppp profile one
}

test ppp_profile-3.18 { Modify ppp profile pap_timeout= } \
    { l2tpdRunning && pppProfile } \
    { \
	clearResult
	l2tpConfig test log message=ppp_profile-3.18
	l2tpConfig ppp profile create profile_name=one
	l2tpConfig ppp profile modify profile_name=one pap_timeout=42
	l2tpConfig ppp profile show profile_name=one
	l2tpConfig ppp profile delete profile_name=one
    } \
    {

Created ppp profile one
Modified ppp profile one
Ppp profile one
  trace flags: PROTOCOL FSM API AVP AVPHIDE AVPDATA FUNC XPRT DATA PPP SYSTEM
  mru: 1500, mtu: 1500, mode: SYNC|ASYNC
  allowed authentications: PAP CHAP MSCHAP MSCHAPv2 EAP 
  max connect time: 0, max failure count: 10, idle timeout: 0
  multilink: NO
  IP parameters:-
    local address: NOT SET, peer address: NOT SET
    dns addresses: NOT SET / NOT SET
    wins addresses: NOT SET / NOT SET
    use radius: NO
  PAP parameters:-
    max auth requests: 10, restart interval: 3, timeout: 42
  CHAP parameters:-
    interval: 10, max challenge: 10, restart: 3
  LCP parameters:-
    echo failure count: 0, echo interval: 0
    max config requests: 10, max config naks: 10
    max terminate requests: 3, retransmit interval: 3
  IPCP parameters:-
    max config requests: 10, max config naks: 10
    max terminate requests: 3, retransmit interval: 3
  use count: 0

Deleted ppp profile one
}

test ppp_profile-3.19 { Modify ppp profile ipcp_max_config_requests= } \
    { l2tpdRunning && pppProfile } \
    { \
	clearResult
	l2tpConfig test log message=ppp_profile-3.19
	l2tpConfig ppp profile create profile_name=one
	l2tpConfig ppp profile modify profile_name=one ipcp_max_config_requests=42
	l2tpConfig ppp profile show profile_name=one
	l2tpConfig ppp profile delete profile_name=one
    } \
    {

Created ppp profile one
Modified ppp profile one
Ppp profile one
  trace flags: PROTOCOL FSM API AVP AVPHIDE AVPDATA FUNC XPRT DATA PPP SYSTEM
  mru: 1500, mtu: 1500, mode: SYNC|ASYNC
  allowed authentications: PAP CHAP MSCHAP MSCHAPv2 EAP 
  max connect time: 0, max failure count: 10, idle timeout: 0
  multilink: NO
  IP parameters:-
    local address: NOT SET, peer address: NOT SET
    dns addresses: NOT SET / NOT SET
    wins addresses: NOT SET / NOT SET
    use radius: NO
  PAP parameters:-
    max auth requests: 10, restart interval: 3, timeout: 0
  CHAP parameters:-
    interval: 10, max challenge: 10, restart: 3
  LCP parameters:-
    echo failure count: 0, echo interval: 0
    max config requests: 10, max config naks: 10
    max terminate requests: 3, retransmit interval: 3
  IPCP parameters:-
    max config requests: 42, max config naks: 10
    max terminate requests: 3, retransmit interval: 3
  use count: 0

Deleted ppp profile one
}

test ppp_profile-3.20 { Modify ppp profile ipcp_max_config_naks= } \
    { l2tpdRunning && pppProfile } \
    { \
	clearResult
	l2tpConfig test log message=ppp_profile-3.20
	l2tpConfig ppp profile create profile_name=one
	l2tpConfig ppp profile modify profile_name=one ipcp_max_config_naks=42
	l2tpConfig ppp profile show profile_name=one
	l2tpConfig ppp profile delete profile_name=one
    } \
    {

Created ppp profile one
Modified ppp profile one
Ppp profile one
  trace flags: PROTOCOL FSM API AVP AVPHIDE AVPDATA FUNC XPRT DATA PPP SYSTEM
  mru: 1500, mtu: 1500, mode: SYNC|ASYNC
  allowed authentications: PAP CHAP MSCHAP MSCHAPv2 EAP 
  max connect time: 0, max failure count: 10, idle timeout: 0
  multilink: NO
  IP parameters:-
    local address: NOT SET, peer address: NOT SET
    dns addresses: NOT SET / NOT SET
    wins addresses: NOT SET / NOT SET
    use radius: NO
  PAP parameters:-
    max auth requests: 10, restart interval: 3, timeout: 0
  CHAP parameters:-
    interval: 10, max challenge: 10, restart: 3
  LCP parameters:-
    echo failure count: 0, echo interval: 0
    max config requests: 10, max config naks: 10
    max terminate requests: 3, retransmit interval: 3
  IPCP parameters:-
    max config requests: 10, max config naks: 42
    max terminate requests: 3, retransmit interval: 3
  use count: 0

Deleted ppp profile one
}

test ppp_profile-3.21 { Modify ppp profile ipcp_max_terminate_requests= } \
    { l2tpdRunning && pppProfile } \
    { \
	clearResult
	l2tpConfig test log message=ppp_profile-3.21
	l2tpConfig ppp profile create profile_name=one
	l2tpConfig ppp profile modify profile_name=one ipcp_max_terminate_requests=42
	l2tpConfig ppp profile show profile_name=one
	l2tpConfig ppp profile delete profile_name=one
    } \
    {

Created ppp profile one
Modified ppp profile one
Ppp profile one
  trace flags: PROTOCOL FSM API AVP AVPHIDE AVPDATA FUNC XPRT DATA PPP SYSTEM
  mru: 1500, mtu: 1500, mode: SYNC|ASYNC
  allowed authentications: PAP CHAP MSCHAP MSCHAPv2 EAP 
  max connect time: 0, max failure count: 10, idle timeout: 0
  multilink: NO
  IP parameters:-
    local address: NOT SET, peer address: NOT SET
    dns addresses: NOT SET / NOT SET
    wins addresses: NOT SET / NOT SET
    use radius: NO
  PAP parameters:-
    max auth requests: 10, restart interval: 3, timeout: 0
  CHAP parameters:-
    interval: 10, max challenge: 10, restart: 3
  LCP parameters:-
    echo failure count: 0, echo interval: 0
    max config requests: 10, max config naks: 10
    max terminate requests: 3, retransmit interval: 3
  IPCP parameters:-
    max config requests: 10, max config naks: 10
    max terminate requests: 42, retransmit interval: 3
  use count: 0

Deleted ppp profile one
}

test ppp_profile-3.22 { Modify ppp profile ipcp_retransmit_interval= } \
    { l2tpdRunning && pppProfile } \
    { \
	clearResult
	l2tpConfig test log message=ppp_profile-3.22
	l2tpConfig ppp profile create profile_name=one
	l2tpConfig ppp profile modify profile_name=one ipcp_retransmit_interval=42
	l2tpConfig ppp profile show profile_name=one
	l2tpConfig ppp profile delete profile_name=one
    } \
    {

Created ppp profile one
Modified ppp profile one
Ppp profile one
  trace flags: PROTOCOL FSM API AVP AVPHIDE AVPDATA FUNC XPRT DATA PPP SYSTEM
  mru: 1500, mtu: 1500, mode: SYNC|ASYNC
  allowed authentications: PAP CHAP MSCHAP MSCHAPv2 EAP 
  max connect time: 0, max failure count: 10, idle timeout: 0
  multilink: NO
  IP parameters:-
    local address: NOT SET, peer address: NOT SET
    dns addresses: NOT SET / NOT SET
    wins addresses: NOT SET / NOT SET
    use radius: NO
  PAP parameters:-
    max auth requests: 10, restart interval: 3, timeout: 0
  CHAP parameters:-
    interval: 10, max challenge: 10, restart: 3
  LCP parameters:-
    echo failure count: 0, echo interval: 0
    max config requests: 10, max config naks: 10
    max terminate requests: 3, retransmit interval: 3
  IPCP parameters:-
    max config requests: 10, max config naks: 10
    max terminate requests: 3, retransmit interval: 42
  use count: 0

Deleted ppp profile one
}

test ppp_profile-3.23 { Modify ppp profile lcp_echo_failure_count= } \
    { l2tpdRunning && pppProfile } \
    { \
	clearResult
	l2tpConfig test log message=ppp_profile-3.23
	l2tpConfig ppp profile create profile_name=one
	l2tpConfig ppp profile modify profile_name=one lcp_echo_failure_count=42
	l2tpConfig ppp profile show profile_name=one
	l2tpConfig ppp profile delete profile_name=one
    } \
    {

Created ppp profile one
Modified ppp profile one
Ppp profile one
  trace flags: PROTOCOL FSM API AVP AVPHIDE AVPDATA FUNC XPRT DATA PPP SYSTEM
  mru: 1500, mtu: 1500, mode: SYNC|ASYNC
  allowed authentications: PAP CHAP MSCHAP MSCHAPv2 EAP 
  max connect time: 0, max failure count: 10, idle timeout: 0
  multilink: NO
  IP parameters:-
    local address: NOT SET, peer address: NOT SET
    dns addresses: NOT SET / NOT SET
    wins addresses: NOT SET / NOT SET
    use radius: NO
  PAP parameters:-
    max auth requests: 10, restart interval: 3, timeout: 0
  CHAP parameters:-
    interval: 10, max challenge: 10, restart: 3
  LCP parameters:-
    echo failure count: 42, echo interval: 0
    max config requests: 10, max config naks: 10
    max terminate requests: 3, retransmit interval: 3
  IPCP parameters:-
    max config requests: 10, max config naks: 10
    max terminate requests: 3, retransmit interval: 3
  use count: 0

Deleted ppp profile one
}

test ppp_profile-3.24 { Modify ppp profile lcp_echo_interval= } \
    { l2tpdRunning && pppProfile } \
    { \
	clearResult
	l2tpConfig test log message=ppp_profile-3.24
	l2tpConfig ppp profile create profile_name=one
	l2tpConfig ppp profile modify profile_name=one lcp_echo_interval=42
	l2tpConfig ppp profile show profile_name=one
	l2tpConfig ppp profile delete profile_name=one
    } \
    {

Created ppp profile one
Modified ppp profile one
Ppp profile one
  trace flags: PROTOCOL FSM API AVP AVPHIDE AVPDATA FUNC XPRT DATA PPP SYSTEM
  mru: 1500, mtu: 1500, mode: SYNC|ASYNC
  allowed authentications: PAP CHAP MSCHAP MSCHAPv2 EAP 
  max connect time: 0, max failure count: 10, idle timeout: 0
  multilink: NO
  IP parameters:-
    local address: NOT SET, peer address: NOT SET
    dns addresses: NOT SET / NOT SET
    wins addresses: NOT SET / NOT SET
    use radius: NO
  PAP parameters:-
    max auth requests: 10, restart interval: 3, timeout: 0
  CHAP parameters:-
    interval: 10, max challenge: 10, restart: 3
  LCP parameters:-
    echo failure count: 0, echo interval: 42
    max config requests: 10, max config naks: 10
    max terminate requests: 3, retransmit interval: 3
  IPCP parameters:-
    max config requests: 10, max config naks: 10
    max terminate requests: 3, retransmit interval: 3
  use count: 0

Deleted ppp profile one
}

test ppp_profile-3.25 { Modify ppp profile lcp_max_config_requests= } \
    { l2tpdRunning && pppProfile } \
    { \
	clearResult
	l2tpConfig test log message=ppp_profile-3.25
	l2tpConfig ppp profile create profile_name=one
	l2tpConfig ppp profile modify profile_name=one lcp_max_config_requests=42
	l2tpConfig ppp profile show profile_name=one
	l2tpConfig ppp profile delete profile_name=one
    } \
    {

Created ppp profile one
Modified ppp profile one
Ppp profile one
  trace flags: PROTOCOL FSM API AVP AVPHIDE AVPDATA FUNC XPRT DATA PPP SYSTEM
  mru: 1500, mtu: 1500, mode: SYNC|ASYNC
  allowed authentications: PAP CHAP MSCHAP MSCHAPv2 EAP 
  max connect time: 0, max failure count: 10, idle timeout: 0
  multilink: NO
  IP parameters:-
    local address: NOT SET, peer address: NOT SET
    dns addresses: NOT SET / NOT SET
    wins addresses: NOT SET / NOT SET
    use radius: NO
  PAP parameters:-
    max auth requests: 10, restart interval: 3, timeout: 0
  CHAP parameters:-
    interval: 10, max challenge: 10, restart: 3
  LCP parameters:-
    echo failure count: 0, echo interval: 0
    max config requests: 42, max config naks: 10
    max terminate requests: 3, retransmit interval: 3
  IPCP parameters:-
    max config requests: 10, max config naks: 10
    max terminate requests: 3, retransmit interval: 3
  use count: 0

Deleted ppp profile one
}

test ppp_profile-3.26 { Modify ppp profile lcp_max_config_naks= } \
    { l2tpdRunning && pppProfile } \
    { \
	clearResult
	l2tpConfig test log message=ppp_profile-3.26
	l2tpConfig ppp profile create profile_name=one
	l2tpConfig ppp profile modify profile_name=one lcp_max_config_naks=42
	l2tpConfig ppp profile show profile_name=one
	l2tpConfig ppp profile delete profile_name=one
    } \
    {

Created ppp profile one
Modified ppp profile one
Ppp profile one
  trace flags: PROTOCOL FSM API AVP AVPHIDE AVPDATA FUNC XPRT DATA PPP SYSTEM
  mru: 1500, mtu: 1500, mode: SYNC|ASYNC
  allowed authentications: PAP CHAP MSCHAP MSCHAPv2 EAP 
  max connect time: 0, max failure count: 10, idle timeout: 0
  multilink: NO
  IP parameters:-
    local address: NOT SET, peer address: NOT SET
    dns addresses: NOT SET / NOT SET
    wins addresses: NOT SET / NOT SET
    use radius: NO
  PAP parameters:-
    max auth requests: 10, restart interval: 3, timeout: 0
  CHAP parameters:-
    interval: 10, max challenge: 10, restart: 3
  LCP parameters:-
    echo failure count: 0, echo interval: 0
    max config requests: 10, max config naks: 42
    max terminate requests: 3, retransmit interval: 3
  IPCP parameters:-
    max config requests: 10, max config naks: 10
    max terminate requests: 3, retransmit interval: 3
  use count: 0

Deleted ppp profile one
}

test ppp_profile-3.27 { Modify ppp profile lcp_max_terminate_requests= } \
    { l2tpdRunning && pppProfile } \
    { \
	clearResult
	l2tpConfig test log message=ppp_profile-3.27
	l2tpConfig ppp profile create profile_name=one
	l2tpConfig ppp profile modify profile_name=one lcp_max_terminate_requests=42
	l2tpConfig ppp profile show profile_name=one
	l2tpConfig ppp profile delete profile_name=one
    } \
    {

Created ppp profile one
Modified ppp profile one
Ppp profile one
  trace flags: PROTOCOL FSM API AVP AVPHIDE AVPDATA FUNC XPRT DATA PPP SYSTEM
  mru: 1500, mtu: 1500, mode: SYNC|ASYNC
  allowed authentications: PAP CHAP MSCHAP MSCHAPv2 EAP 
  max connect time: 0, max failure count: 10, idle timeout: 0
  multilink: NO
  IP parameters:-
    local address: NOT SET, peer address: NOT SET
    dns addresses: NOT SET / NOT SET
    wins addresses: NOT SET / NOT SET
    use radius: NO
  PAP parameters:-
    max auth requests: 10, restart interval: 3, timeout: 0
  CHAP parameters:-
    interval: 10, max challenge: 10, restart: 3
  LCP parameters:-
    echo failure count: 0, echo interval: 0
    max config requests: 10, max config naks: 10
    max terminate requests: 42, retransmit interval: 3
  IPCP parameters:-
    max config requests: 10, max config naks: 10
    max terminate requests: 3, retransmit interval: 3
  use count: 0

Deleted ppp profile one
}

test ppp_profile-3.28 { Modify ppp profile lcp_retransmit_interval= } \
    { l2tpdRunning && pppProfile } \
    { \
	clearResult
	l2tpConfig test log message=ppp_profile-3.28
	l2tpConfig ppp profile create profile_name=one
	l2tpConfig ppp profile modify profile_name=one lcp_retransmit_interval=42
	l2tpConfig ppp profile show profile_name=one
	l2tpConfig ppp profile delete profile_name=one
    } \
    {

Created ppp profile one
Modified ppp profile one
Ppp profile one
  trace flags: PROTOCOL FSM API AVP AVPHIDE AVPDATA FUNC XPRT DATA PPP SYSTEM
  mru: 1500, mtu: 1500, mode: SYNC|ASYNC
  allowed authentications: PAP CHAP MSCHAP MSCHAPv2 EAP 
  max connect time: 0, max failure count: 10, idle timeout: 0
  multilink: NO
  IP parameters:-
    local address: NOT SET, peer address: NOT SET
    dns addresses: NOT SET / NOT SET
    wins addresses: NOT SET / NOT SET
    use radius: NO
  PAP parameters:-
    max auth requests: 10, restart interval: 3, timeout: 0
  CHAP parameters:-
    interval: 10, max challenge: 10, restart: 3
  LCP parameters:-
    echo failure count: 0, echo interval: 0
    max config requests: 10, max config naks: 10
    max terminate requests: 3, retransmit interval: 42
  IPCP parameters:-
    max config requests: 10, max config naks: 10
    max terminate requests: 3, retransmit interval: 3
  use count: 0

Deleted ppp profile one
}

test ppp_profile-3.29 { Modify ppp profile max_connect_time= } \
    { l2tpdRunning && pppProfile } \
    { \
	clearResult
	l2tpConfig test log message=ppp_profile-3.29
	l2tpConfig ppp profile create profile_name=one
	l2tpConfig ppp profile modify profile_name=one max_connect_time=42
	l2tpConfig ppp profile show profile_name=one
	l2tpConfig ppp profile delete profile_name=one
    } \
    {

Created ppp profile one
Modified ppp profile one
Ppp profile one
  trace flags: PROTOCOL FSM API AVP AVPHIDE AVPDATA FUNC XPRT DATA PPP SYSTEM
  mru: 1500, mtu: 1500, mode: SYNC|ASYNC
  allowed authentications: PAP CHAP MSCHAP MSCHAPv2 EAP 
  max connect time: 42, max failure count: 10, idle timeout: 0
  multilink: NO
  IP parameters:-
    local address: NOT SET, peer address: NOT SET
    dns addresses: NOT SET / NOT SET
    wins addresses: NOT SET / NOT SET
    use radius: NO
  PAP parameters:-
    max auth requests: 10, restart interval: 3, timeout: 0
  CHAP parameters:-
    interval: 10, max challenge: 10, restart: 3
  LCP parameters:-
    echo failure count: 0, echo interval: 0
    max config requests: 10, max config naks: 10
    max terminate requests: 3, retransmit interval: 3
  IPCP parameters:-
    max config requests: 10, max config naks: 10
    max terminate requests: 3, retransmit interval: 3
  use count: 0

Deleted ppp profile one
}

test ppp_profile-3.30 { Modify ppp profile local_ipaddr= } \
    { l2tpdRunning && pppProfile } \
    { \
	clearResult
	l2tpConfig test log message=ppp_profile-3.30
	l2tpConfig ppp profile create profile_name=one
	l2tpConfig ppp profile modify profile_name=one local_ipaddr=10.1.2.3
	l2tpConfig ppp profile show profile_name=one
	l2tpConfig ppp profile delete profile_name=one
    } \
    {

Created ppp profile one
Modified ppp profile one
Ppp profile one
  trace flags: PROTOCOL FSM API AVP AVPHIDE AVPDATA FUNC XPRT DATA PPP SYSTEM
  mru: 1500, mtu: 1500, mode: SYNC|ASYNC
  allowed authentications: PAP CHAP MSCHAP MSCHAPv2 EAP 
  max connect time: 0, max failure count: 10, idle timeout: 0
  multilink: NO
  IP parameters:-
    local address: 10.1.2.3, peer address: NOT SET
    dns addresses: NOT SET / NOT SET
    wins addresses: NOT SET / NOT SET
    use radius: NO
  PAP parameters:-
    max auth requests: 10, restart interval: 3, timeout: 0
  CHAP parameters:-
    interval: 10, max challenge: 10, restart: 3
  LCP parameters:-
    echo failure count: 0, echo interval: 0
    max config requests: 10, max config naks: 10
    max terminate requests: 3, retransmit interval: 3
  IPCP parameters:-
    max config requests: 10, max config naks: 10
    max terminate requests: 3, retransmit interval: 3
  use count: 0

Deleted ppp profile one
}

test ppp_profile-3.31 { Modify ppp profile remote_ipaddr= } \
    { l2tpdRunning && pppProfile } \
    { \
	clearResult
	l2tpConfig test log message=ppp_profile-3.31
	l2tpConfig ppp profile create profile_name=one
	l2tpConfig ppp profile modify profile_name=one remote_ipaddr=10.1.2.3
	l2tpConfig ppp profile show profile_name=one
	l2tpConfig ppp profile delete profile_name=one
    } \
    {

Created ppp profile one
Modified ppp profile one
Ppp profile one
  trace flags: PROTOCOL FSM API AVP AVPHIDE AVPDATA FUNC XPRT DATA PPP SYSTEM
  mru: 1500, mtu: 1500, mode: SYNC|ASYNC
  allowed authentications: PAP CHAP MSCHAP MSCHAPv2 EAP 
  max connect time: 0, max failure count: 10, idle timeout: 0
  multilink: NO
  IP parameters:-
    local address: NOT SET, peer address: 10.1.2.3
    dns addresses: NOT SET / NOT SET
    wins addresses: NOT SET / NOT SET
    use radius: NO
  PAP parameters:-
    max auth requests: 10, restart interval: 3, timeout: 0
  CHAP parameters:-
    interval: 10, max challenge: 10, restart: 3
  LCP parameters:-
    echo failure count: 0, echo interval: 0
    max config requests: 10, max config naks: 10
    max terminate requests: 3, retransmit interval: 3
  IPCP parameters:-
    max config requests: 10, max config naks: 10
    max terminate requests: 3, retransmit interval: 3
  use count: 0

Deleted ppp profile one
}

test ppp_profile-3.32 { Modify ppp profile dns_ipaddr_pri= } \
    { l2tpdRunning && pppProfile } \
    { \
	clearResult
	l2tpConfig test log message=ppp_profile-3.32
	l2tpConfig ppp profile create profile_name=one
	l2tpConfig ppp profile modify profile_name=one dns_ipaddr_pri=10.1.2.3
	l2tpConfig ppp profile show profile_name=one
	l2tpConfig ppp profile delete profile_name=one
    } \
    {

Created ppp profile one
Modified ppp profile one
Ppp profile one
  trace flags: PROTOCOL FSM API AVP AVPHIDE AVPDATA FUNC XPRT DATA PPP SYSTEM
  mru: 1500, mtu: 1500, mode: SYNC|ASYNC
  allowed authentications: PAP CHAP MSCHAP MSCHAPv2 EAP 
  max connect time: 0, max failure count: 10, idle timeout: 0
  multilink: NO
  IP parameters:-
    local address: NOT SET, peer address: NOT SET
    dns addresses: 10.1.2.3 / NOT SET
    wins addresses: NOT SET / NOT SET
    use radius: NO
  PAP parameters:-
    max auth requests: 10, restart interval: 3, timeout: 0
  CHAP parameters:-
    interval: 10, max challenge: 10, restart: 3
  LCP parameters:-
    echo failure count: 0, echo interval: 0
    max config requests: 10, max config naks: 10
    max terminate requests: 3, retransmit interval: 3
  IPCP parameters:-
    max config requests: 10, max config naks: 10
    max terminate requests: 3, retransmit interval: 3
  use count: 0

Deleted ppp profile one
}

test ppp_profile-3.33 { Modify ppp profile dns_ipaddr_sec= } \
    { l2tpdRunning && pppProfile } \
    { \
	clearResult
	l2tpConfig test log message=ppp_profile-3.33
	l2tpConfig ppp profile create profile_name=one
	l2tpConfig ppp profile modify profile_name=one dns_ipaddr_sec=10.1.2.3
	l2tpConfig ppp profile show profile_name=one
	l2tpConfig ppp profile delete profile_name=one
    } \
    {

Created ppp profile one
Modified ppp profile one
Ppp profile one
  trace flags: PROTOCOL FSM API AVP AVPHIDE AVPDATA FUNC XPRT DATA PPP SYSTEM
  mru: 1500, mtu: 1500, mode: SYNC|ASYNC
  allowed authentications: PAP CHAP MSCHAP MSCHAPv2 EAP 
  max connect time: 0, max failure count: 10, idle timeout: 0
  multilink: NO
  IP parameters:-
    local address: NOT SET, peer address: NOT SET
    dns addresses: NOT SET / 10.1.2.3
    wins addresses: NOT SET / NOT SET
    use radius: NO
  PAP parameters:-
    max auth requests: 10, restart interval: 3, timeout: 0
  CHAP parameters:-
    interval: 10, max challenge: 10, restart: 3
  LCP parameters:-
    echo failure count: 0, echo interval: 0
    max config requests: 10, max config naks: 10
    max terminate requests: 3, retransmit interval: 3
  IPCP parameters:-
    max config requests: 10, max config naks: 10
    max terminate requests: 3, retransmit interval: 3
  use count: 0

Deleted ppp profile one
}

test ppp_profile-3.34 { Modify ppp profile wins_ipaddr_pri= } \
    { l2tpdRunning && pppProfile } \
    { \
	clearResult
	l2tpConfig test log message=ppp_profile-3.34
	l2tpConfig ppp profile create profile_name=one
	l2tpConfig ppp profile modify profile_name=one wins_ipaddr_pri=10.1.2.3
	l2tpConfig ppp profile show profile_name=one
	l2tpConfig ppp profile delete profile_name=one
    } \
    {

Created ppp profile one
Modified ppp profile one
Ppp profile one
  trace flags: PROTOCOL FSM API AVP AVPHIDE AVPDATA FUNC XPRT DATA PPP SYSTEM
  mru: 1500, mtu: 1500, mode: SYNC|ASYNC
  allowed authentications: PAP CHAP MSCHAP MSCHAPv2 EAP 
  max connect time: 0, max failure count: 10, idle timeout: 0
  multilink: NO
  IP parameters:-
    local address: NOT SET, peer address: NOT SET
    dns addresses: NOT SET / NOT SET
    wins addresses: 10.1.2.3 / NOT SET
    use radius: NO
  PAP parameters:-
    max auth requests: 10, restart interval: 3, timeout: 0
  CHAP parameters:-
    interval: 10, max challenge: 10, restart: 3
  LCP parameters:-
    echo failure count: 0, echo interval: 0
    max config requests: 10, max config naks: 10
    max terminate requests: 3, retransmit interval: 3
  IPCP parameters:-
    max config requests: 10, max config naks: 10
    max terminate requests: 3, retransmit interval: 3
  use count: 0

Deleted ppp profile one
}

test ppp_profile-3.35 { Modify ppp profile wins_ipaddr_sec= } \
    { l2tpdRunning && pppProfile } \
    { \
	clearResult
	l2tpConfig test log message=ppp_profile-3.35
	l2tpConfig ppp profile create profile_name=one
	l2tpConfig ppp profile modify profile_name=one wins_ipaddr_sec=10.1.2.3
	l2tpConfig ppp profile show profile_name=one
	l2tpConfig ppp profile delete profile_name=one
    } \
    {

Created ppp profile one
Modified ppp profile one
Ppp profile one
  trace flags: PROTOCOL FSM API AVP AVPHIDE AVPDATA FUNC XPRT DATA PPP SYSTEM
  mru: 1500, mtu: 1500, mode: SYNC|ASYNC
  allowed authentications: PAP CHAP MSCHAP MSCHAPv2 EAP 
  max connect time: 0, max failure count: 10, idle timeout: 0
  multilink: NO
  IP parameters:-
    local address: NOT SET, peer address: NOT SET
    dns addresses: NOT SET / NOT SET
    wins addresses: NOT SET / 10.1.2.3
    use radius: NO
  PAP parameters:-
    max auth requests: 10, restart interval: 3, timeout: 0
  CHAP parameters:-
    interval: 10, max challenge: 10, restart: 3
  LCP parameters:-
    echo failure count: 0, echo interval: 0
    max config requests: 10, max config naks: 10
    max terminate requests: 3, retransmit interval: 3
  IPCP parameters:-
    max config requests: 10, max config naks: 10
    max terminate requests: 3, retransmit interval: 3
  use count: 0

Deleted ppp profile one
}

test ppp_profile-3.36 { Modify ppp profile ip_pool_name= } \
    { l2tpdRunning && pppProfile } \
    { \
	clearResult
	l2tpConfig test log message=ppp_profile-3.36
	l2tpConfig ppp profile create profile_name=one
	l2tpConfig ppp profile modify profile_name=one ip_pool_name=wibble
	l2tpConfig ppp profile show profile_name=one
	l2tpConfig ppp profile delete profile_name=one
    } \
    {

Created ppp profile one
Modified ppp profile one
Ppp profile one
  trace flags: PROTOCOL FSM API AVP AVPHIDE AVPDATA FUNC XPRT DATA PPP SYSTEM
  mru: 1500, mtu: 1500, mode: SYNC|ASYNC
  allowed authentications: PAP CHAP MSCHAP MSCHAPv2 EAP 
  max connect time: 0, max failure count: 10, idle timeout: 0
  multilink: NO
  IP parameters:-
    local address: NOT SET, peer address: NOT SET
    dns addresses: NOT SET / NOT SET
    wins addresses: NOT SET / NOT SET
    ip pool name: wibble
    use radius: NO
  PAP parameters:-
    max auth requests: 10, restart interval: 3, timeout: 0
  CHAP parameters:-
    interval: 10, max challenge: 10, restart: 3
  LCP parameters:-
    echo failure count: 0, echo interval: 0
    max config requests: 10, max config naks: 10
    max terminate requests: 3, retransmit interval: 3
  IPCP parameters:-
    max config requests: 10, max config naks: 10
    max terminate requests: 3, retransmit interval: 3
  use count: 0

Deleted ppp profile one
}

test ppp_profile-3.37 { Modify ppp profile use_radius= } \
    { l2tpdRunning && pppProfile } \
    { \
	clearResult
	l2tpConfig test log message=ppp_profile-3.37
	l2tpConfig ppp profile create profile_name=one
	l2tpConfig ppp profile modify profile_name=one use_radius=yes
	l2tpConfig ppp profile show profile_name=one
	l2tpConfig ppp profile delete profile_name=one
    } \
    {

Created ppp profile one
Modified ppp profile one
Ppp profile one
  trace flags: PROTOCOL FSM API AVP AVPHIDE AVPDATA FUNC XPRT DATA PPP SYSTEM
  mru: 1500, mtu: 1500, mode: SYNC|ASYNC
  allowed authentications: PAP CHAP MSCHAP MSCHAPv2 EAP 
  max connect time: 0, max failure count: 10, idle timeout: 0
  multilink: NO
  IP parameters:-
    local address: NOT SET, peer address: NOT SET
    dns addresses: NOT SET / NOT SET
    wins addresses: NOT SET / NOT SET
    use radius: YES
  PAP parameters:-
    max auth requests: 10, restart interval: 3, timeout: 0
  CHAP parameters:-
    interval: 10, max challenge: 10, restart: 3
  LCP parameters:-
    echo failure count: 0, echo interval: 0
    max config requests: 10, max config naks: 10
    max terminate requests: 3, retransmit interval: 3
  IPCP parameters:-
    max config requests: 10, max config naks: 10
    max terminate requests: 3, retransmit interval: 3
  use count: 0

Deleted ppp profile one
}

test ppp_profile-3.38 { Modify ppp profile radius_hint= } \
    { l2tpdRunning && pppProfile } \
    { \
	clearResult
	l2tpConfig test log message=ppp_profile-3.38
	l2tpConfig ppp profile create profile_name=one
	l2tpConfig ppp profile modify profile_name=one use_radius=yes radius_hint=wibble
	l2tpConfig ppp profile show profile_name=one
	l2tpConfig ppp profile delete profile_name=one
    } \
    {

Created ppp profile one
Modified ppp profile one
Ppp profile one
  trace flags: PROTOCOL FSM API AVP AVPHIDE AVPDATA FUNC XPRT DATA PPP SYSTEM
  mru: 1500, mtu: 1500, mode: SYNC|ASYNC
  allowed authentications: PAP CHAP MSCHAP MSCHAPv2 EAP 
  max connect time: 0, max failure count: 10, idle timeout: 0
  multilink: NO
  IP parameters:-
    local address: NOT SET, peer address: NOT SET
    dns addresses: NOT SET / NOT SET
    wins addresses: NOT SET / NOT SET
    use radius: YES
    radius hint: wibble
  PAP parameters:-
    max auth requests: 10, restart interval: 3, timeout: 0
  CHAP parameters:-
    interval: 10, max challenge: 10, restart: 3
  LCP parameters:-
    echo failure count: 0, echo interval: 0
    max config requests: 10, max config naks: 10
    max terminate requests: 3, retransmit interval: 3
  IPCP parameters:-
    max config requests: 10, max config naks: 10
    max terminate requests: 3, retransmit interval: 3
  use count: 0

Deleted ppp profile one
}

test ppp_profile-3.39 { Modify ppp profile radius_hint= } \
    { l2tpdRunning && pppProfile } \
    { \
	clearResult
	l2tpConfig test log message=ppp_profile-3.39
	l2tpConfig ppp profile create profile_name=one
	l2tpConfig ppp profile modify profile_name=one multilink=yes
	l2tpConfig ppp profile show profile_name=one
	l2tpConfig ppp profile delete profile_name=one
    } \
    {

Created ppp profile one
Modified ppp profile one
Ppp profile one
  trace flags: PROTOCOL FSM API AVP AVPHIDE AVPDATA FUNC XPRT DATA PPP SYSTEM
  mru: 1500, mtu: 1500, mode: SYNC|ASYNC
  allowed authentications: PAP CHAP MSCHAP MSCHAPv2 EAP 
  max connect time: 0, max failure count: 10, idle timeout: 0
  multilink: YES
  IP parameters:-
    local address: NOT SET, peer address: NOT SET
    dns addresses: NOT SET / NOT SET
    wins addresses: NOT SET / NOT SET
    use radius: NO
  PAP parameters:-
    max auth requests: 10, restart interval: 3, timeout: 0
  CHAP parameters:-
    interval: 10, max challenge: 10, restart: 3
  LCP parameters:-
    echo failure count: 0, echo interval: 0
    max config requests: 10, max config naks: 10
    max terminate requests: 3, retransmit interval: 3
  IPCP parameters:-
    max config requests: 10, max config naks: 10
    max terminate requests: 3, retransmit interval: 3
  use count: 0

Deleted ppp profile one
}

test ppp_profile-3.40 { Complex ppp profile modify with all args } \
    { l2tpdRunning && pppProfile } \
    { \
	clearResult
	l2tpConfig test log message=ppp_profile-3.40
	l2tpConfig ppp profile create profile_name=one
	l2tpConfig ppp profile modify profile_name=one \
	  trace_flags=15 \
	  asyncmap=0x42 \
	  mtu=42 \
	  mru=42 \
	  sync_mode=async \
	  auth_pap=no \
	  auth_chap=no \
	  auth_mschapv1=no \
	  auth_mschapv2=no \
	  auth_eap=no \
	  auth_none=yes \
	  chap_interval=42 \
	  chap_max_challenge=42 \
	  chap_restart=42 \
	  pap_max_auth_requests=42 \
	  pap_restart_interval=42 \
	  pap_timeout=42 \
	  idle_timeout=42 \
	  ipcp_max_config_requests=42 \
	  ipcp_max_config_naks=42 \
	  ipcp_max_terminate_requests=42 \
	  ipcp_retransmit_interval=42 \
	  lcp_echo_failure_count=42 \
	  lcp_echo_interval=42 \
	  lcp_max_config_requests=42 \
	  lcp_max_config_naks=42 \
	  lcp_max_terminate_requests=42 \
	  lcp_retransmit_interval=42 \
	  max_connect_time=42 \
	  max_failure_count=42 \
	  local_ipaddr=10.0.0.1 \
	  remote_ipaddr=10.0.0.2 \
	  dns_ipaddr_pri=10.0.0.3 \
	  dns_ipaddr_sec=10.0.0.4 \
	  wins_ipaddr_pri=10.0.0.5 \
	  wins_ipaddr_sec=10.0.0.6 \
	  ip_pool_name=wibble \
	  use_radius=yes \
	  radius_hint=wibble \
	  multilink=yes
	l2tpConfig ppp profile show profile_name=one
	l2tpConfig ppp profile delete profile_name=one
    } \
    {

Created ppp profile one
Modified ppp profile one
Ppp profile one
  trace flags: PROTOCOL FSM API AVP
  mru: 42, mtu: 42, mode: ASYNC
  allowed authentications: NOAUTH 
  max connect time: 42, max failure count: 42, idle timeout: 42
  asyncmap: 0x42
  multilink: YES
  IP parameters:-
    local address: 10.0.0.1, peer address: 10.0.0.2
    dns addresses: 10.0.0.3 / 10.0.0.4
    wins addresses: 10.0.0.5 / 10.0.0.6
    ip pool name: wibble
    use radius: YES
    radius hint: wibble
  PAP parameters:-
    max auth requests: 42, restart interval: 42, timeout: 42
  CHAP parameters:-
    interval: 42, max challenge: 42, restart: 42
  LCP parameters:-
    echo failure count: 42, echo interval: 42
    max config requests: 42, max config naks: 42
    max terminate requests: 42, retransmit interval: 42
  IPCP parameters:-
    max config requests: 42, max config naks: 42
    max terminate requests: 42, retransmit interval: 42
  use count: 0

Deleted ppp profile one
}

############################################################################
# Tests 4.* - config save/restore
############################################################################

test ppp_profile-4.1 { Save a created ppp profile } \
    { l2tpdRunning && pppProfile } \
    { \
	clearResult
	l2tpConfig test log message=ppp_profile-4.1
	l2tpConfig test modify default_config
        l2tpConfig ppp profile create profile_name=one
	l2tpConfig config save file=results/ppp_profile-4.1.cfg
	catFile results/ppp_profile-4.1.cfg
	l2tpConfig ppp profile delete profile_name=one
    } \
    {

Modified test config
Created ppp profile one

$
# system$
$
# peer profiles$
$
# tunnel profiles$
$
# session profiles$
$
# ppp profiles$
ppp profile create profile_name=one$
$
# locally created tunnels and sessions$
Deleted ppp profile one
}

test ppp_profile-4.2 { Save all set parameters of a ppp profile } \
    { l2tpdRunning && pppProfile } \
    { \
	clearResult
	l2tpConfig test log message=ppp_profile-4.2
	l2tpConfig test modify default_config
        l2tpConfig ppp profile create profile_name=one \
	  trace_flags=15 \
	  asyncmap=0x42 \
	  mtu=42 \
	  mru=42 \
	  use_radius=yes \
	  radius_hint=wibble \
	  sync_mode=async \
	  auth_pap=no \
	  auth_chap=no \
	  auth_mschapv1=no \
	  auth_mschapv2=no \
	  auth_eap=no \
	  auth_none=yes \
	  chap_interval=42 \
	  chap_max_challenge=42 \
	  chap_restart=42 \
	  pap_max_auth_requests=42 \
	  pap_restart_interval=42 \
	  pap_timeout=42 \
	  idle_timeout=42 \
	  ipcp_max_config_requests=42 \
	  ipcp_max_config_naks=42 \
	  ipcp_max_terminate_requests=42 \
	  ipcp_retransmit_interval=42 \
	  lcp_echo_failure_count=42 \
	  lcp_echo_interval=42 \
	  lcp_max_config_requests=42 \
	  lcp_max_config_naks=42 \
	  lcp_max_terminate_requests=42 \
	  lcp_retransmit_interval=42 \
	  max_connect_time=42 \
	  max_failure_count=42 \
	  local_ipaddr=10.0.0.1 \
	  remote_ipaddr=10.0.0.2 \
	  dns_ipaddr_pri=10.0.0.3 \
	  dns_ipaddr_sec=10.0.0.4 \
	  wins_ipaddr_pri=10.0.0.5 \
	  wins_ipaddr_sec=10.0.0.6 \
	  ip_pool_name=wibble
	l2tpConfig config save file=results/ppp_profile-4.2.cfg
	catFile results/ppp_profile-4.2.cfg
	l2tpConfig ppp profile delete profile_name=one
    } \
    {

Modified test config
Created ppp profile one

$
# system$
$
# peer profiles$
$
# tunnel profiles$
$
# session profiles$
$
# ppp profiles$
ppp profile create profile_name=one$
ppp profile modify profile_name=one \$
	trace_flags=15 \$
	asyncmap=66 \$
	mru=42 \$
	mtu=42 \$
	use_radius=yes \$
	radius_hint=wibble \$
	auth_pap=off \$
	auth_chap=off \$
	auth_mschapv1=off \$
	auth_mschapv2=off \$
	auth_eap=off \$
	auth_none=yes \$
	sync_mode=async \$
	chap_interval=42 \$
	chap_max_challenge=42 \$
	chap_restart=42 \$
	pap_max_auth_requests=42 \$
	pap_restart_interval=42 \$
	pap_timeout=42 \$
	idle_timeout=42 \$
	ipcp_max_config_requests=42 \$
	ipcp_max_config_naks=42 \$
	ipcp_max_terminate_requests=42 \$
	ipcp_retransmit_interval=42 \$
	lcp_echo_failure_count=42 \$
	lcp_echo_interval=42 \$
	lcp_max_config_requests=42 \$
	lcp_max_config_naks=42 \$
	lcp_max_terminate_requests=42 \$
	lcp_retransmit_interval=42 \$
	max_connect_time=42 \$
	max_failure_count=42 \$
	dns_ipaddr_pri=10.0.0.3 \$
	dns_ipaddr_sec=10.0.0.4 \$
	wins_ipaddr_pri=10.0.0.5 \$
	wins_ipaddr_sec=10.0.0.6 \$
	local_ipaddr=10.0.0.1 \$
	remote_ipaddr=10.0.0.2 \$
	ip_pool_name=wibble \$
$
$
# locally created tunnels and sessions$
Deleted ppp profile one
}

test ppp_profile-4.3 { Save only non-default parameters of a created ppp profile } \
    { l2tpdRunning && pppProfile } \
    { \
	clearResult
	l2tpConfig test log message=ppp_profile-4.3
	l2tpConfig test modify default_config
        l2tpConfig ppp profile create profile_name=one \
	  trace_flags=15 \
	  sync_mode=async \
	  auth_eap=no \
	  pap_timeout=42 \
	  idle_timeout=42 \
	  local_ipaddr=10.0.0.1 \
	  remote_ipaddr=10.0.0.2 \
	  ip_pool_name=wibble
	l2tpConfig config save file=results/ppp_profile-4.3.cfg
	catFile results/ppp_profile-4.3.cfg
	l2tpConfig ppp profile delete profile_name=one
    } \
    {

Modified test config
Created ppp profile one

$
# system$
$
# peer profiles$
$
# tunnel profiles$
$
# session profiles$
$
# ppp profiles$
ppp profile create profile_name=one$
ppp profile modify profile_name=one \$
	trace_flags=15 \$
	auth_pap=on \$
	auth_chap=on \$
	auth_mschapv1=on \$
	auth_mschapv2=on \$
	auth_eap=off \$
	auth_none=no \$
	sync_mode=async \$
	pap_timeout=42 \$
	idle_timeout=42 \$
	local_ipaddr=10.0.0.1 \$
	remote_ipaddr=10.0.0.2 \$
	ip_pool_name=wibble \$
$
$
# locally created tunnels and sessions$
Deleted ppp profile one
}

test ppp_profile-4.4 { Save all modified values of a ppp profile } \
    { l2tpdRunning && pppProfile } \
    { \
	clearResult
	l2tpConfig test log message=ppp_profile-4.4
	l2tpConfig test modify default_config
        l2tpConfig ppp profile create profile_name=one
        l2tpConfig ppp profile modify profile_name=one \
	  trace_flags=15 \
	  asyncmap=0x42 \
	  mtu=42 \
	  mru=42 \
	  use_radius=yes \
	  radius_hint=wibble \
	  sync_mode=async \
	  auth_pap=no \
	  auth_chap=no \
	  auth_mschapv1=no \
	  auth_mschapv2=no \
	  auth_eap=no \
	  auth_none=yes \
	  chap_interval=42 \
	  chap_max_challenge=42 \
	  chap_restart=42 \
	  pap_max_auth_requests=42 \
	  pap_restart_interval=42 \
	  pap_timeout=42 \
	  idle_timeout=42 \
	  ipcp_max_config_requests=42 \
	  ipcp_max_config_naks=42 \
	  ipcp_max_terminate_requests=42 \
	  ipcp_retransmit_interval=42 \
	  lcp_echo_failure_count=42 \
	  lcp_echo_interval=42 \
	  lcp_max_config_requests=42 \
	  lcp_max_config_naks=42 \
	  lcp_max_terminate_requests=42 \
	  lcp_retransmit_interval=42 \
	  max_connect_time=42 \
	  max_failure_count=42 \
	  local_ipaddr=10.0.0.1 \
	  remote_ipaddr=10.0.0.2 \
	  dns_ipaddr_pri=10.0.0.3 \
	  dns_ipaddr_sec=10.0.0.4 \
	  wins_ipaddr_pri=10.0.0.5 \
	  wins_ipaddr_sec=10.0.0.6 \
	  ip_pool_name=wibble
	l2tpConfig config save file=results/ppp_profile-4.4.cfg
	catFile results/ppp_profile-4.4.cfg
	l2tpConfig ppp profile delete profile_name=one
    } \
    {

Modified test config
Created ppp profile one
Modified ppp profile one

$
# system$
$
# peer profiles$
$
# tunnel profiles$
$
# session profiles$
$
# ppp profiles$
ppp profile create profile_name=one$
ppp profile modify profile_name=one \$
	trace_flags=15 \$
	asyncmap=66 \$
	mru=42 \$
	mtu=42 \$
	use_radius=yes \$
	radius_hint=wibble \$
	auth_pap=off \$
	auth_chap=off \$
	auth_mschapv1=off \$
	auth_mschapv2=off \$
	auth_eap=off \$
	auth_none=yes \$
	sync_mode=async \$
	chap_interval=42 \$
	chap_max_challenge=42 \$
	chap_restart=42 \$
	pap_max_auth_requests=42 \$
	pap_restart_interval=42 \$
	pap_timeout=42 \$
	idle_timeout=42 \$
	ipcp_max_config_requests=42 \$
	ipcp_max_config_naks=42 \$
	ipcp_max_terminate_requests=42 \$
	ipcp_retransmit_interval=42 \$
	lcp_echo_failure_count=42 \$
	lcp_echo_interval=42 \$
	lcp_max_config_requests=42 \$
	lcp_max_config_naks=42 \$
	lcp_max_terminate_requests=42 \$
	lcp_retransmit_interval=42 \$
	max_connect_time=42 \$
	max_failure_count=42 \$
	dns_ipaddr_pri=10.0.0.3 \$
	dns_ipaddr_sec=10.0.0.4 \$
	wins_ipaddr_pri=10.0.0.5 \$
	wins_ipaddr_sec=10.0.0.6 \$
	local_ipaddr=10.0.0.1 \$
	remote_ipaddr=10.0.0.2 \$
	ip_pool_name=wibble \$
$
$
# locally created tunnels and sessions$
Deleted ppp profile one
}

test ppp_profile-4.5 { Save only non-default modified values of a ppp profile } \
    { l2tpdRunning && pppProfile } \
    { \
	clearResult
	l2tpConfig test log message=ppp_profile-4.5
	l2tpConfig test modify default_config
        l2tpConfig ppp profile create profile_name=one
        l2tpConfig ppp profile modify profile_name=one \
	  sync_mode=sync \
	  auth_mschapv1=no \
	  auth_mschapv2=no \
	  ipcp_max_config_requests=42 \
	  ipcp_max_config_naks=42 \
	  dns_ipaddr_pri=10.0.0.3 \
	  dns_ipaddr_sec=10.0.0.4 \
	  wins_ipaddr_pri=10.0.0.5 \
	  wins_ipaddr_sec=10.0.0.6 \
	  ip_pool_name=wibble
	l2tpConfig config save file=results/ppp_profile-4.5.cfg
	catFile results/ppp_profile-4.5.cfg
	l2tpConfig ppp profile delete profile_name=one
    } \
    {

Modified test config
Created ppp profile one
Modified ppp profile one

$
# system$
$
# peer profiles$
$
# tunnel profiles$
$
# session profiles$
$
# ppp profiles$
ppp profile create profile_name=one$
ppp profile modify profile_name=one \$
	auth_pap=on \$
	auth_chap=on \$
	auth_mschapv1=off \$
	auth_mschapv2=off \$
	auth_eap=on \$
	auth_none=no \$
	sync_mode=sync \$
	ipcp_max_config_requests=42 \$
	ipcp_max_config_naks=42 \$
	dns_ipaddr_pri=10.0.0.3 \$
	dns_ipaddr_sec=10.0.0.4 \$
	wins_ipaddr_pri=10.0.0.5 \$
	wins_ipaddr_sec=10.0.0.6 \$
	ip_pool_name=wibble \$
$
$
# locally created tunnels and sessions$
Deleted ppp profile one
}

test ppp_profile-4.6 { Save all created ppp profiles } \
    { l2tpdRunning && pppProfile } \
    { \
	clearResult
	l2tpConfig test log message=ppp_profile-4.6
	l2tpConfig test modify default_config
        l2tpConfig ppp profile create profile_name=one
        l2tpConfig ppp profile create profile_name=two
        l2tpConfig ppp profile create profile_name=three
	l2tpConfig config save file=results/ppp_profile-4.6.cfg
	catFile results/ppp_profile-4.6.cfg
	l2tpConfig ppp profile delete profile_name=one
	l2tpConfig ppp profile delete profile_name=two
	l2tpConfig ppp profile delete profile_name=three
    } \
    {

Modified test config
Created ppp profile one
Created ppp profile two
Created ppp profile three

$
# system$
$
# peer profiles$
$
# tunnel profiles$
$
# session profiles$
$
# ppp profiles$
ppp profile create profile_name=three$
ppp profile create profile_name=two$
ppp profile create profile_name=one$
$
# locally created tunnels and sessions$
Deleted ppp profile one
Deleted ppp profile two
Deleted ppp profile three
}

test ppp_profile-4.7 { Restore all parameters from a saved file } \
    { l2tpdRunning && pppProfile } \
    { \
	clearResult
	l2tpConfig test log message=ppp_profile-4.7
	l2tpConfig test modify default_config
        l2tpConfig ppp profile create profile_name=one \
	  trace_flags=15 \
	  asyncmap=0x42 \
	  mtu=42 \
	  mru=42 \
	  use_radius=yes \
	  radius_hint=wibble \
	  sync_mode=async \
	  auth_pap=no \
	  auth_chap=no \
	  auth_mschapv1=no \
	  auth_mschapv2=no \
	  auth_eap=no \
	  auth_none=yes \
	  chap_interval=42 \
	  chap_max_challenge=42 \
	  chap_restart=42 \
	  pap_max_auth_requests=42 \
	  pap_restart_interval=42 \
	  pap_timeout=42 \
	  idle_timeout=42 \
	  ipcp_max_config_requests=42 \
	  ipcp_max_config_naks=42 \
	  ipcp_max_terminate_requests=42 \
	  ipcp_retransmit_interval=42 \
	  lcp_echo_failure_count=42 \
	  lcp_echo_interval=42 \
	  lcp_max_config_requests=42 \
	  lcp_max_config_naks=42 \
	  lcp_max_terminate_requests=42 \
	  lcp_retransmit_interval=42 \
	  max_connect_time=42 \
	  max_failure_count=42 \
	  local_ipaddr=10.0.0.1 \
	  remote_ipaddr=10.0.0.2 \
	  dns_ipaddr_pri=10.0.0.3 \
	  dns_ipaddr_sec=10.0.0.4 \
	  wins_ipaddr_pri=10.0.0.5 \
	  wins_ipaddr_sec=10.0.0.6 \
	  ip_pool_name=wibble
	l2tpConfig config save file=results/ppp_profile-4.7.cfg
	l2tpConfig ppp profile delete profile_name=one
	l2tpConfig config restore file=results/ppp_profile-4.7.cfg
	l2tpConfig ppp profile show profile_name=one
	l2tpConfig ppp profile delete profile_name=one
    } \
    {

Modified test config
Created ppp profile one

Deleted ppp profile one
Created ppp profile one
Modified ppp profile one
Ppp profile one
  trace flags: PROTOCOL FSM API AVP
  mru: 42, mtu: 42, mode: ASYNC
  allowed authentications: NOAUTH 
  max connect time: 42, max failure count: 42, idle timeout: 42
  asyncmap: 0x42
  multilink: NO
  IP parameters:-
    local address: 10.0.0.1, peer address: 10.0.0.2
    dns addresses: 10.0.0.3 / 10.0.0.4
    wins addresses: 10.0.0.5 / 10.0.0.6
    ip pool name: wibble
    use radius: YES
    radius hint: wibble
  PAP parameters:-
    max auth requests: 42, restart interval: 42, timeout: 42
  CHAP parameters:-
    interval: 42, max challenge: 42, restart: 42
  LCP parameters:-
    echo failure count: 42, echo interval: 42
    max config requests: 42, max config naks: 42
    max terminate requests: 42, retransmit interval: 42
  IPCP parameters:-
    max config requests: 42, max config naks: 42
    max terminate requests: 42, retransmit interval: 42
  use count: 0

Deleted ppp profile one
}

test ppp_profile-4.8 { Restore multiple ppp profiles } \
    { l2tpdRunning && pppProfile } \
    { \
	clearResult
	l2tpConfig test log message=ppp_profile-4.8
	l2tpConfig test modify default_config
        l2tpConfig ppp profile create profile_name=one \
	  trace_flags=15 \
	  lcp_retransmit_interval=42
        l2tpConfig ppp profile create profile_name=two \
	  pap_max_auth_requests=42 \
	  pap_restart_interval=42 \
	  pap_timeout=42 \
	  ip_pool_name=wibble
        l2tpConfig ppp profile create profile_name=three \
	  trace_flags=15 \
	  asyncmap=0x42 \
	  mtu=42 \
	  mru=42 \
	  sync_mode=async \
	  auth_pap=no \
	  auth_chap=no \
	  auth_mschapv1=no \
	  auth_mschapv2=no \
	  auth_eap=no \
	  auth_none=yes \
	  chap_interval=42 \
	  chap_max_challenge=42 \
	  chap_restart=42 \
	  pap_max_auth_requests=42 \
	  pap_restart_interval=42 \
	  pap_timeout=42 \
	  idle_timeout=42 \
	  ipcp_max_config_requests=42 \
	  ipcp_max_config_naks=42 \
	  ipcp_max_terminate_requests=42 \
	  ipcp_retransmit_interval=42 \
	  lcp_echo_failure_count=42 \
	  lcp_echo_interval=42 \
	  lcp_max_config_requests=42 \
	  lcp_max_config_naks=42 \
	  lcp_max_terminate_requests=42 \
	  lcp_retransmit_interval=42 \
	  max_connect_time=42 \
	  max_failure_count=42 \
	  local_ipaddr=10.0.0.1 \
	  remote_ipaddr=10.0.0.2 \
	  dns_ipaddr_pri=10.0.0.3 \
	  dns_ipaddr_sec=10.0.0.4 \
	  wins_ipaddr_pri=10.0.0.5 \
	  wins_ipaddr_sec=10.0.0.6 \
	  ip_pool_name=wibble
	l2tpConfig config save file=results/ppp_profile-4.8.cfg
	l2tpConfig ppp profile delete profile_name=one
	l2tpConfig ppp profile delete profile_name=two
	l2tpConfig ppp profile delete profile_name=three
	l2tpConfig config restore file=results/ppp_profile-4.8.cfg
	l2tpConfig ppp profile list
	l2tpConfig ppp profile show profile_name=one
	l2tpConfig ppp profile show profile_name=two
	l2tpConfig ppp profile show profile_name=three

	l2tpConfig ppp profile delete profile_name=one
	l2tpConfig ppp profile delete profile_name=two
	l2tpConfig ppp profile delete profile_name=three
    } \
    {

Modified test config
Created ppp profile one
Created ppp profile two
Created ppp profile three

Deleted ppp profile one
Deleted ppp profile two
Deleted ppp profile three
Created ppp profile three
Modified ppp profile three
Created ppp profile two
Modified ppp profile two
Created ppp profile one
Modified ppp profile one
	default
	one
	three
	two
Ppp profile one
  trace flags: PROTOCOL FSM API AVP
  mru: 1500, mtu: 1500, mode: SYNC|ASYNC
  allowed authentications: PAP CHAP MSCHAP MSCHAPv2 EAP 
  max connect time: 0, max failure count: 10, idle timeout: 0
  multilink: NO
  IP parameters:-
    local address: NOT SET, peer address: NOT SET
    dns addresses: NOT SET / NOT SET
    wins addresses: NOT SET / NOT SET
    use radius: NO
  PAP parameters:-
    max auth requests: 10, restart interval: 3, timeout: 0
  CHAP parameters:-
    interval: 10, max challenge: 10, restart: 3
  LCP parameters:-
    echo failure count: 0, echo interval: 0
    max config requests: 10, max config naks: 10
    max terminate requests: 3, retransmit interval: 42
  IPCP parameters:-
    max config requests: 10, max config naks: 10
    max terminate requests: 3, retransmit interval: 3
  use count: 0

Ppp profile two
  trace flags: PROTOCOL FSM API AVP AVPHIDE AVPDATA FUNC XPRT DATA PPP SYSTEM
  mru: 1500, mtu: 1500, mode: SYNC|ASYNC
  allowed authentications: PAP CHAP MSCHAP MSCHAPv2 EAP 
  max connect time: 0, max failure count: 10, idle timeout: 0
  multilink: NO
  IP parameters:-
    local address: NOT SET, peer address: NOT SET
    dns addresses: NOT SET / NOT SET
    wins addresses: NOT SET / NOT SET
    ip pool name: wibble
    use radius: NO
  PAP parameters:-
    max auth requests: 42, restart interval: 42, timeout: 42
  CHAP parameters:-
    interval: 10, max challenge: 10, restart: 3
  LCP parameters:-
    echo failure count: 0, echo interval: 0
    max config requests: 10, max config naks: 10
    max terminate requests: 3, retransmit interval: 3
  IPCP parameters:-
    max config requests: 10, max config naks: 10
    max terminate requests: 3, retransmit interval: 3
  use count: 0

Ppp profile three
  trace flags: PROTOCOL FSM API AVP
  mru: 42, mtu: 42, mode: ASYNC
  allowed authentications: NOAUTH 
  max connect time: 42, max failure count: 42, idle timeout: 42
  asyncmap: 0x42
  multilink: NO
  IP parameters:-
    local address: 10.0.0.1, peer address: 10.0.0.2
    dns addresses: 10.0.0.3 / 10.0.0.4
    wins addresses: 10.0.0.5 / 10.0.0.6
    ip pool name: wibble
    use radius: NO
  PAP parameters:-
    max auth requests: 42, restart interval: 42, timeout: 42
  CHAP parameters:-
    interval: 42, max challenge: 42, restart: 42
  LCP parameters:-
    echo failure count: 42, echo interval: 42
    max config requests: 42, max config naks: 42
    max terminate requests: 42, retransmit interval: 42
  IPCP parameters:-
    max config requests: 42, max config naks: 42
    max terminate requests: 42, retransmit interval: 42
  use count: 0

Deleted ppp profile one
Deleted ppp profile two
Deleted ppp profile three
}

